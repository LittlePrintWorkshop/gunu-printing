<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>건우프린팅 - 소량인쇄부터 대량인쇄까지</title>
  <link rel="icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cmVjdCB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgZmlsbD0iIzI1NjNlYiIvPjx0ZXh0IHg9IjI1NiIgeT0iMzgwIiBmb250LXNpemU9IjI4MCIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiPkc8L3RleHQ+PC9zdmc+" type="image/svg+xml">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
  <script src="https://code.jquery.com/jquery-3.4.1.min.js" crossorigin="anonymous"></script>
  <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.18/lang/summernote-ko-KR.min.js"></script>
  <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
  <!-- PayApp 결제 라이브러리 -->
  <script src="https://lite.payapp.kr/public/api/v2/payapp-lite.js"></script>

  <link rel="stylesheet" href="style.css">
</head>

<body>
  <div class="container">

    <header class="header">
      <div class="header-top">
        <div class="brand" onclick="goHome()">
          <div class="brand-info" style="display:flex; align-items:center;">
            <img id="brand-logo" src="" alt="GuNU Printing 로고" style="height:44px; width:auto; display:none;" />
          </div>
        </div>

        <nav class="top-nav" id="nav-links"></nav>
      </div>

      <div class="header-bottom">
        <button class="menu-btn" onclick="toggleFullMenu()">☰</button>
        <div class="cat-nav">
          <div class="cat-nav-item">
            <a onclick="setCategory('indigo')" class="cat-link">소량 인디고</a>
            <div class="cat-dropdown">
              <a onclick="setCategory('indigo', 'staple')">중철</a>
              <a onclick="setCategory('indigo', 'perfect')">무선</a>
            </div>
          </div>
          <div class="cat-nav-item">
            <a onclick="setCategory('digital')" class="cat-link">흑백 디지털</a>
            <div class="cat-dropdown">
              <a onclick="setCategory('digital', 'staple')">중철</a>
              <a onclick="setCategory('digital', 'perfect')">무선</a>
            </div>
          </div>
          <div class="cat-nav-item">
            <a onclick="setCategory('offset')" class="cat-link">대량 옵셋</a>
            <div class="cat-dropdown">
              <a onclick="setCategory('offset', 'staple')">중철</a>
              <a onclick="setCategory('offset', 'perfect')">무선</a>
            </div>
          </div>
          <a onclick="setCategory('flyer_small')" class="cat-link">소량 전단</a>
          <a onclick="setCategory('flyer_large')" class="cat-link">대량 전단</a>
        </div>
        
        <div class="full-menu-panel" id="full-menu-panel">
          <div class="full-menu-content">
            <div class="full-menu-category-section" id="menu-cat-indigo">
              <div class="full-menu-category-title">소량 인디고</div>
              <div class="full-menu-columns">
                <div class="full-menu-column">
                  <div class="full-menu-column-title">중철</div>
                  <a href="#" class="full-menu-column-item" onclick="event.preventDefault(); setCategory('indigo', 'staple'); toggleFullMenu();">소량 인디고 중철</a>
                </div>
                <div class="full-menu-column">
                  <div class="full-menu-column-title">무선</div>
                  <a href="#" class="full-menu-column-item" onclick="event.preventDefault(); setCategory('indigo', 'perfect'); toggleFullMenu();">소량 인디고 무선</a>
                </div>
              </div>
            </div>
            
            <div class="full-menu-category-section" id="menu-cat-digital">
              <div class="full-menu-category-title">흑백 디지털</div>
              <div class="full-menu-columns">
                <div class="full-menu-column">
                  <div class="full-menu-column-title">중철</div>
                  <a href="#" class="full-menu-column-item" onclick="event.preventDefault(); setCategory('digital', 'staple'); toggleFullMenu();">흑백 디지털 중철</a>
                </div>
                <div class="full-menu-column">
                  <div class="full-menu-column-title">무선</div>
                  <a href="#" class="full-menu-column-item" onclick="event.preventDefault(); setCategory('digital', 'perfect'); toggleFullMenu();">흑백 디지털 무선</a>
                </div>
              </div>
            </div>
            
            <div class="full-menu-category-section" id="menu-cat-offset">
              <div class="full-menu-category-title">대량 옵셋</div>
              <div class="full-menu-columns">
                <div class="full-menu-column">
                  <div class="full-menu-column-title">중철</div>
                  <a href="#" class="full-menu-column-item" onclick="event.preventDefault(); setCategory('offset', 'staple'); toggleFullMenu();">대량 옵셋 중철</a>
                </div>
                <div class="full-menu-column">
                  <div class="full-menu-column-title">무선</div>
                  <a href="#" class="full-menu-column-item" onclick="event.preventDefault(); setCategory('offset', 'perfect'); toggleFullMenu();">대량 옵셋 무선</a>
                </div>
              </div>
            </div>
            
            <div class="full-menu-category-section" id="menu-cat-flyer_small">
              <div class="full-menu-category-title">소량 전단</div>
              <div class="full-menu-columns">
                <div class="full-menu-column">
                  <div class="full-menu-column-title">소량 전단</div>
                  <a href="#" class="full-menu-column-item" onclick="event.preventDefault(); setCategory('flyer_small'); toggleFullMenu();">소량 전단</a>
                </div>
              </div>
            </div>
            
            <div class="full-menu-category-section" id="menu-cat-flyer_large">
              <div class="full-menu-category-title">대량 전단</div>
              <div class="full-menu-columns">
                <div class="full-menu-column">
                  <div class="full-menu-column-title">대량 전단</div>
                  <a href="#" class="full-menu-column-item" onclick="event.preventDefault(); setCategory('flyer_large'); toggleFullMenu();">대량 전단</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- 동적 페이지 렌더링용 컨테이너 (개인결제/완료 화면 등) -->
    <div class="main-content" style="display:none;
      max-width:1000px; margin:0 auto; padding:10px;">
    </div>

    <div id="view-home">
      <div class="home-grid">

        <div class="home-row">
          <div class="hero-left">
            <div class="home-slider" id="home-slider">
              <!-- 슬라이드는 JavaScript에서 동적으로 생성됨 -->
              <div style="position:absolute; bottom:20px; right:20px; z-index:10;">
                <div class="home-pager" id="home-pager"></div>
              </div>
            </div>
          </div>

          <div style="display:flex; flex-direction:column; gap:16px;">
            <div class="card home-login-card" style="padding:10px 14px 8px 14px; box-sizing:border-box;">
              <div class="card-body" style="padding:0;">
                <div id="home-login-form">
                <form onsubmit="return login(event)">
                  <div style="margin-bottom:6px;">
                    <input type="text" id="userId" placeholder="아이디" style="width:100%; padding:8px 10px; border:1px solid var(--line); border-radius:var(--radius); font-size:13px; margin-bottom:4px;">
                    <input type="password" id="userPassword" placeholder="비밀번호" style="width:100%; padding:8px 10px; border:1px solid var(--line); border-radius:var(--radius); font-size:13px;">
                  </div>
                  <button type="submit" class="btn btn-primary" style="width:100%; padding:8px 0; font-size:14px; font-weight:600; margin-bottom:6px;">로그인</button>
                </form>
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:0;">
                  <a onclick="goFindAccount()" style="color:var(--muted); font-size:12px; font-weight:600; cursor:pointer;">ID·PW 찾기</a>
                  <a onclick="goSignup()" style="color:var(--muted); font-size:12px; font-weight:600; cursor:pointer;">회원가입</a>
                </div>
                </div>
                
                <div id="home-user-welcome" style="display:none;">
                  <div style="text-align:center; padding:20px 0; margin-bottom:0px;">
                    <div style="font-size:20px; font-weight:900; color:#0f172a; margin-bottom:4px;" id="home-user-name">회원님</div>
                    <div style="font-size:13px; color:#64748b; margin-bottom:8px;">환영합니다!</div>
                    <button onclick="goAccountEdit()" style="background:none; border:none; color:#3b82f6; cursor:pointer; font-size:13px; text-decoration:underline; padding:0;">정보수정</button>
                  </div>
                  <button onclick="logout()" class="btn btn-secondary" style="width:100%; padding:10px 0; font-size:14px; font-weight:600; margin-bottom:10px;">로그아웃</button>
                </div>
                
                <div class="home-shortcuts" style="margin-top:0;">
                  <div class="sc" onclick="goCart()"><div class="sico">🛒</div><div class="stxt">장바구니</div></div>
                  <div class="sc" onclick="goOrderHistory()"><div class="sico">📄</div><div class="stxt">주문조회</div></div>
                </div>
              </div>
            </div>

            <div class="card home-notice" style="margin-top:0;">
              <div class="notice-head">
                <div class="ttl">NOTICE</div>
                <div class="more" onclick="goNoticeList()">더보기</div>
              </div>
              <div class="notice-list" id="home-notice-list"></div>
            </div>
          </div>
        </div>
      </div>

        <div class="home-best" style="margin-top: 10px;">
          <div class="best-head">
            <div>
              <p class="best-label">BEST</p>
              <p class="best-title">베스트 상품</p>
            </div>
            <p class="best-sub">지금 인기 있는 상품 4종</p>
          </div>
          <div class="best-grid">
            <button class="best-item" data-cat="indigo" onclick="setCategory('indigo'); return false;" aria-label="소량 인디고 견적 이동">
              <img src="images/1768914051899_20260121_103946.png" alt="소량 인디고" class="best-thumb" onerror="this.style.display='none'; this.parentElement.style.background='#f1f5f9'; const noImg = document.createElement('div'); noImg.style.cssText='width:100%; height:100%; display:flex; align-items:center; justify-content:center; color:#64748b; font-size:14px; font-weight:700;'; noImg.textContent='No Image'; this.parentElement.appendChild(noImg);">
            </button>
            <button class="best-item" data-cat="digital" onclick="setCategory('digital'); return false;" aria-label="흑백 디지털 견적 이동">
              <img src="images/KakaoTalk_20260121_094315265_20260121_120308.png" alt="흑백 디지털" class="best-thumb" onerror="this.style.display='none'; this.parentElement.style.background='#f1f5f9'; const noImg = document.createElement('div'); noImg.style.cssText='width:100%; height:100%; display:flex; align-items:center; justify-content:center; color:#64748b; font-size:14px; font-weight:700;'; noImg.textContent='No Image'; this.parentElement.appendChild(noImg);">
            </button>
            <button class="best-item" data-cat="offset" onclick="setCategory('offset'); return false;" aria-label="대량 옵셋 견적 이동">
              <img src="images/KakaoTalk_20260121_102449905_20260122_120629.png" alt="대량 옵셋" class="best-thumb" onerror="this.style.display='none'; this.parentElement.style.background='#f1f5f9'; const noImg = document.createElement('div'); noImg.style.cssText='width:100%; height:100%; display:flex; align-items:center; justify-content:center; color:#64748b; font-size:14px; font-weight:700;'; noImg.textContent='No Image'; this.parentElement.appendChild(noImg);">
            </button>
            <button class="best-item" data-cat="flyer_small" onclick="setCategory('flyer_small'); return false;" aria-label="소량 전단 견적 이동">
              <img src="images/KakaoTalk_20260121_102449905_20260123_101237.png" alt="소량 전단" class="best-thumb" onerror="this.style.display='none'; this.parentElement.style.background='#f1f5f9'; const noImg = document.createElement('div'); noImg.style.cssText='width:100%; height:100%; display:flex; align-items:center; justify-content:center; color:#64748b; font-size:14px; font-weight:700;'; noImg.textContent='No Image'; this.parentElement.appendChild(noImg);">
            </button>
          </div>
        </div>

      </div>
    </div>

    <div id="view-signup" style="display:none;">
      <div class="card" style="max-width:700px; margin:0 auto;">
        <div style="padding:14px 18px; border-bottom:1px solid var(--line); font-weight:1100; background:#f8fbff;">회원가입</div>
        <div style="padding:18px;">
          
          <div id="signup-step-1" style="text-align:center; padding:30px 0;">
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px;">
              <div onclick="startSignup('general')" style="padding:40px 20px; border:2px solid var(--line); border-radius:16px; cursor:pointer; transition:.2s; background:#fff; display:flex; flex-direction:column; align-items:center; gap:15px;" onmouseover="this.style.borderColor='var(--primary)'; this.style.boxShadow='0 10px 30px rgba(3,122,63,0.1)'" onmouseout="this.style.borderColor='var(--line)'; this.style.boxShadow='none'">
                <div style="font-size:48px; background:#f0fdf4; width:100px; height:100px; display:flex; align-items:center; justify-content:center; border-radius:50%; color:var(--primary);">👤</div>
                <h4 style="font-size:20px; font-weight:1100; color:#0f172a; margin:0;">일반회원</h4>
                <p style="font-size:14px; color:#64748b; margin:0;">개인 고객님을 위한<br>간편 회원가입</p>
                <button class="btn btn-primary" style="width:auto; margin-top:10px; padding:8px 16px;">가입하기</button>
              </div>
              <div onclick="startSignup('business')" style="padding:40px 20px; border:2px solid var(--line); border-radius:16px; cursor:pointer; transition:.2s; background:#fff; display:flex; flex-direction:column; align-items:center; gap:15px;" onmouseover="this.style.borderColor='var(--primary)'; this.style.boxShadow='0 10px 30px rgba(3,122,63,0.1)'" onmouseout="this.style.borderColor='var(--line)'; this.style.boxShadow='none'">
                <div style="font-size:48px; background:#f0fdf4; width:100px; height:100px; display:flex; align-items:center; justify-content:center; border-radius:50%; color:var(--primary);">🏢</div>
                <h4 style="font-size:20px; font-weight:1100; color:#0f172a; margin:0;">사업자회원</h4>
                <p style="font-size:14px; color:#64748b; margin:0;">사업자 등록증 첨부 및<br>관리자 승인 필요</p>
                <button class="btn btn-secondary" style="width:auto; margin-top:10px; padding:8px 16px;">가입하기</button>
              </div>
            </div>
          </div>

          <div id="signup-step-2" style="display:none;">
            <button class="btn btn-secondary" onclick="backToStep1()" style="margin-bottom:20px; background:#e2e8f0; color:#475569;">← 뒤로가기</button>
            
            <h3 style="font-weight:1100; margin:0 0 12px 0; border-left:4px solid var(--primary); padding-left:8px;">약관 동의</h3>
            
            <div style="margin-bottom:20px;">
              <div style="display:flex; align-items:center; gap:8px; margin-bottom:12px; cursor:pointer;" onclick="toggleAllTerms()">
                <input type="checkbox" id="check-all" style="width:18px; height:18px;">
                <label for="check-all" style="font-size:14px; font-weight:1100; color:#333; margin:0; cursor:pointer;">약관 전체 동의</label>
              </div>

              <label style="display:block; font-weight:700; font-size:12px; margin-bottom:6px; color:#475569;">이용약관 [필수]</label>
              <textarea readonly style="width:100%; height:150px; overflow-y:auto; background:#f8fafc; border:1px solid #cbd5e1; border-radius:8px; padding:15px; font-size:12px; color:#475569; line-height:1.6; margin-bottom:8px; resize:none;">이용약관에 동의합니다. 자세한 내용은 사이트를 참고하세요.</textarea>
              <div style="display:flex; align-items:center; gap:8px; margin-bottom:20px;">
                <input type="checkbox" id="term1" style="width:18px; height:18px;">
                <label for="term1" style="font-size:13px; font-weight:600; margin:0; cursor:pointer;">이용약관에 동의합니다.</label>
              </div>

              <label style="display:block; font-weight:700; font-size:12px; margin-bottom:6px; color:#475569;">개인정보 수집 [필수]</label>
              <textarea readonly style="width:100%; height:150px; overflow-y:auto; background:#f8fafc; border:1px solid #cbd5e1; border-radius:8px; padding:15px; font-size:12px; color:#475569; line-height:1.6; margin-bottom:8px; resize:none;">개인정보 수집 및 이용에 동의합니다. 자세한 내용은 사이트를 참고하세요.</textarea>
              <div style="display:flex; align-items:center; gap:8px; margin-bottom:20px;">
                <input type="checkbox" id="term2" style="width:18px; height:18px;">
                <label for="term2" style="font-size:13px; font-weight:600; margin:0; cursor:pointer;">개인정보 수집에 동의합니다.</label>
              </div>
            </div>

            <h3 style="font-weight:1100; margin:0 0 12px 0; border-left:4px solid var(--primary); padding-left:8px;">로그인 정보</h3>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px; margin-bottom:20px;">
              <div style="grid-column:span 2; display:flex; gap:10px;">
                <input type="text" id="sign-id" placeholder="아이디" style="flex:1; padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px;">
                <button class="btn btn-secondary" onclick="checkIdDuplicate()" style="width:100px; padding:10px; font-size:12px;">중복확인</button>
              </div>
              <div><input type="password" id="sign-pw" placeholder="비밀번호" style="padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px; width:100%;"></div>
              <div><input type="password" id="sign-pw2" placeholder="비밀번호 확인" style="padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px; width:100%;"></div>
            </div>

            <h3 style="font-weight:1100; margin:0 0 12px 0; border-left:4px solid var(--primary); padding-left:8px;">회원 정보</h3>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px; margin-bottom:20px;">
              <div><input type="text" id="sign-name" placeholder="이름" style="padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px; width:100%;"></div>
              <div><input type="text" id="sign-phone" placeholder="휴대폰번호" style="padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px; width:100%;"></div>
              <div style="grid-column:span 2; display:flex; gap:10px;">
                <input type="text" id="sign-addr" placeholder="주소" readonly onclick="openAddressSearch()" style="flex:1; padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px; cursor:pointer;">
                <button class="btn btn-secondary" onclick="openAddressSearch()" style="width:100px; padding:10px; font-size:12px;">주소검색</button>
              </div>
              <div style="grid-column:span 2;"><input type="text" id="sign-addr-detail" placeholder="상세주소" style="padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px; width:100%;"></div>
            </div>

            <div id="area-business" style="display:none; background:#f8fafc; padding:15px; border-radius:8px; margin-bottom:20px;">
              <h3 style="font-weight:1100; margin:0 0 12px 0; color:var(--primary);">사업자 정보 (승인 필요)</h3>
              <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px;">
                <div><input type="text" id="sign-biz-name" placeholder="상호명" style="padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px; width:100%;"></div>
                <div><input type="text" id="sign-biz-num" placeholder="사업자등록번호" style="padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px; width:100%;"></div>
                <div style="grid-column:span 2;">
                  <label style="display:block; font-weight:700; font-size:12px; margin-bottom:6px; color:#475569;">사업자등록증 첨부</label>
                  <input type="file" id="sign-biz-file" style="padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px; width:100%;">
                </div>
              </div>
            </div>

            <button class="btn btn-primary" onclick="submitSignup()" style="margin-top:20px;">가입하기</button>
          </div>
        </div>
      </div>
    </div>

    <div id="view-login" style="display:none;">
      <div class="card" style="max-width:400px; margin:50px auto; text-align:center;">
        <div style="padding:14px 18px; border-bottom:1px solid var(--line); font-weight:1100; background:#f8fbff;">로그인</div>
        <div style="padding:18px;">
          <form onsubmit="login(event); return false;" style="margin:0;">
            <input type="text" id="login-id" placeholder="아이디" style="width:100%; padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px; margin-bottom:10px;">
            <input type="password" id="login-pw" placeholder="비밀번호" style="width:100%; padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px; margin-bottom:20px;">
            <button type="submit" class="btn btn-primary" style="width:100%; cursor:pointer;">로그인</button>
          </form>
          <div style="margin-top:15px; font-size:13px; color:#64748b;">
            계정이 없으신가요? <a onclick="goSignup()" style="color:var(--home-primary); cursor:pointer; font-weight:1100;">회원가입</a>
            <span style="margin:0 8px; color:#e6edf3;">|</span>
            <a onclick="goFindAccount()" style="color:var(--home-primary); cursor:pointer; font-weight:1100;">ID·PW 찾기</a>
          </div>
        </div>
      </div>
    </div>

    <div id="view-account-edit" style="display:none;">
      <div class="card" style="max-width:600px; margin:50px auto;">
        <div style="padding:14px 18px; border-bottom:1px solid var(--line); font-weight:1100; background:#f8fbff;">회원정보 수정</div>
        <div style="padding:18px;">
          <h3 style="font-weight:1100; margin:0 0 12px 0; border-left:4px solid var(--primary); padding-left:8px;">기본 정보</h3>
          <div style="display:grid; grid-template-columns:1fr; gap:15px; margin-bottom:20px;">
            <div>
              <label style="display:block; font-weight:700; font-size:12px; margin-bottom:6px; color:#475569;">아이디 (변경불가)</label>
              <input type="text" id="edit-id" readonly style="padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#e2e8f0; font-size:13px; width:100%; color:#64748b;">
            </div>
            <div>
              <label style="display:block; font-weight:700; font-size:12px; margin-bottom:6px; color:#475569;">이름</label>
              <input type="text" id="edit-name" placeholder="이름" style="padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px; width:100%;">
            </div>
            <div>
              <label style="display:block; font-weight:700; font-size:12px; margin-bottom:6px; color:#475569;">휴대폰번호</label>
              <input type="text" id="edit-phone" placeholder="휴대폰번호" style="padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px; width:100%;">
            </div>
          </div>

          <h3 style="font-weight:1100; margin:0 0 12px 0; border-left:4px solid var(--primary); padding-left:8px;">주소 정보</h3>
          <div style="display:grid; grid-template-columns:1fr; gap:15px; margin-bottom:20px;">
            <div style="display:flex; gap:10px;">
              <input type="text" id="edit-addr" placeholder="주소" readonly onclick="openAddressSearchForEdit()" style="flex:1; padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px; cursor:pointer;">
              <button class="btn btn-secondary" onclick="openAddressSearchForEdit()" style="width:100px; padding:10px; font-size:12px;">주소검색</button>
            </div>
            <div>
              <input type="text" id="edit-addr-detail" placeholder="상세주소" style="padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px; width:100%;">
            </div>
          </div>

          <h3 style="font-weight:1100; margin:0 0 12px 0; border-left:4px solid var(--primary); padding-left:8px;">비밀번호 변경 (선택)</h3>
          <div style="display:grid; grid-template-columns:1fr; gap:15px; margin-bottom:20px;">
            <div>
              <input type="password" id="edit-current-pw" placeholder="현재 비밀번호" style="padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px; width:100%;">
            </div>
            <div>
              <input type="password" id="edit-new-pw" placeholder="새 비밀번호" style="padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px; width:100%;">
            </div>
            <div>
              <input type="password" id="edit-new-pw2" placeholder="새 비밀번호 확인" style="padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px; width:100%;">
            </div>
          </div>

          <div id="edit-business-area" style="display:none; background:#f8fafc; padding:15px; border-radius:8px; margin-bottom:20px;">
            <h3 style="font-weight:1100; margin:0 0 12px 0; color:var(--primary);">사업자 정보</h3>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px;">
              <div>
                <label style="display:block; font-weight:700; font-size:12px; margin-bottom:6px; color:#475569;">상호명</label>
                <input type="text" id="edit-biz-name" placeholder="상호명" style="padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px; width:100%;">
              </div>
              <div>
                <label style="display:block; font-weight:700; font-size:12px; margin-bottom:6px; color:#475569;">사업자등록번호</label>
                <input type="text" id="edit-biz-num" placeholder="사업자등록번호" style="padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px; width:100%;">
              </div>
            </div>
          </div>

          <div style="display:flex; gap:10px; margin-top:20px;">
            <button class="btn btn-primary" onclick="submitAccountEdit()" style="flex:1;">수정하기</button>
            <button class="btn btn-secondary" onclick="goHome()" style="flex:1;">취소</button>
          </div>
        </div>
      </div>
    </div>

    <div id="view-find" style="display:none;">
      <div style="max-width:500px; margin:50px auto;">
        <div class="card">
          <div style="padding:14px 18px; border-bottom:1px solid var(--line); font-weight:1100; background:#f8fbff; display:flex; justify-content:space-between; align-items:center;">
            <span>ID·PW 찾기</span>
            <button onclick="goLogin()" style="border:none; background:none; font-size:20px; cursor:pointer; color:#64748b;">✕</button>
          </div>
          <div style="padding:18px;">
            <div style="display:flex; gap:10px; margin-bottom:20px; background:#f8fafc; padding:5px; border-radius:8px;">
              <button id="find-id-tab" class="btn" onclick="switchFindTab('id')" style="flex:1; padding:10px; background:var(--home-primary); color:#fff; font-weight:1000; border:none;">아이디 찾기</button>
              <button id="find-pw-tab" class="btn" onclick="switchFindTab('pw')" style="flex:1; padding:10px; background:#fff; color:#64748b; font-weight:1000; border:none;">비밀번호 찾기</button>
            </div>

            <div id="find-id-panel">
              <h3 style="font-weight:1100; margin:0 0 12px 0; border-left:4px solid var(--primary); padding-left:8px; font-size:14px;">가입 시 입력한 정보를 입력해주세요</h3>
              <div style="margin-bottom:15px;">
                <label style="display:block; font-weight:700; font-size:12px; margin-bottom:6px; color:#475569;">이름</label>
                <input type="text" id="find-id-name" placeholder="이름" style="width:100%; padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px;">
              </div>
              <div style="margin-bottom:20px;">
                <label style="display:block; font-weight:700; font-size:12px; margin-bottom:6px; color:#475569;">휴대폰번호</label>
                <input type="text" id="find-id-phone" placeholder="010-0000-0000" style="width:100%; padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px;">
              </div>
              <button class="btn btn-primary" onclick="findId()">아이디 찾기</button>
              <div id="find-id-result" style="margin-top:20px; display:none; padding:15px; background:#ecfdf5; border:1px solid #10b981; border-radius:8px; text-align:center;">
                <p style="margin:0 0 8px 0; font-size:12px; color:#064e3b; font-weight:600;">회원님의 아이디는</p>
                <p style="margin:0; font-size:18px; color:#047857; font-weight:1000;" id="found-id"></p>
              </div>
            </div>

            <div id="find-pw-panel" style="display:none;">
              <h3 style="font-weight:1100; margin:0 0 12px 0; border-left:4px solid var(--primary); padding-left:8px; font-size:14px;">가입 시 입력한 정보를 입력해주세요</h3>
              <div style="margin-bottom:15px;">
                <label style="display:block; font-weight:700; font-size:12px; margin-bottom:6px; color:#475569;">아이디</label>
                <input type="text" id="find-pw-id" placeholder="아이디" style="width:100%; padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px;">
              </div>
              <div style="margin-bottom:15px;">
                <label style="display:block; font-weight:700; font-size:12px; margin-bottom:6px; color:#475569;">이름</label>
                <input type="text" id="find-pw-name" placeholder="이름" style="width:100%; padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px;">
              </div>
              <div style="margin-bottom:20px;">
                <label style="display:block; font-weight:700; font-size:12px; margin-bottom:6px; color:#475569;">휴대폰번호</label>
                <input type="text" id="find-pw-phone" placeholder="010-0000-0000" style="width:100%; padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px;">
              </div>
              <button class="btn btn-primary" onclick="findPassword()">비밀번호 찾기</button>
              <div id="find-pw-result" style="margin-top:20px; display:none; padding:15px; background:#ecfdf5; border:1px solid #10b981; border-radius:8px; text-align:center;">
                <p style="margin:0 0 8px 0; font-size:12px; color:#064e3b; font-weight:600;">회원님의 비밀번호는</p>
                <p style="margin:0; font-size:18px; color:#047857; font-weight:1000;" id="found-pw"></p>
              </div>
            </div>

            <div style="margin-top:20px; text-align:center;">
              <button class="btn" onclick="goLogin()" style="background:#e2e8f0; color:#64748b; border:none;">로그인 페이지로</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="view-order" style="display:none;">
      <div style="max-width:1000px; margin:0 auto;">
        <h2 style="margin-top:0; font-weight:1100; color:#0f172a; border-left:4px solid var(--primary); padding-left:12px;">주문 내역</h2>
        
        <div id="order-history-list" style="display:flex; flex-direction:column; gap:15px; margin-bottom:20px;"></div>
        
        <div id="order-empty" style="display:none; text-align:center; padding:60px 20px; background:#f8fafc; border-radius:16px; border:2px dashed var(--line); color:#64748b;">
          <div style="font-size:48px; margin-bottom:16px;">📦</div>
          <div style="font-size:16px; font-weight:700; margin-bottom:8px;">주문 내역이 없습니다</div>
          <div style="font-size:14px;">주문하신 내역이 여기에 표시됩니다</div>
        </div>
      </div>
    </div>

    <div id="view-cart" style="display:none;">
      <div style="max-width:1200px; margin:0 auto; padding:0 18px;">
        <h2 style="margin-top:0;">장바구니 확인</h2>
        <div id="cart-list" style="display:flex; flex-direction:column; gap:15px; margin-bottom:20px;"></div>
        <div style="background:white; border-radius:var(--radius); padding:18px; border:1px solid var(--line);">
          <div style="display:flex; justify-content:space-between; margin-bottom:10px; font-size:13px; color:#64748b;">
            <span>총 상품금액</span><strong id="ct-price" style="color:#0f172a;">0원</strong>
          </div>
          <div style="display:flex; justify-content:space-between; margin-bottom:10px; font-size:13px; color:#64748b;">
            <span>총 배송비</span><strong id="ct-ship" style="color:#0f172a;">0원</strong>
          </div>
          <div style="display:flex; justify-content:space-between; padding-top:10px; border-top:1px dashed var(--line); margin-bottom:20px; font-weight:1100;">
            <span>총 결제예정금액</span><strong id="ct-total" style="color:#0f172a;">0원</strong>
          </div>
          <button class="btn btn-primary" onclick="submitOrder()">주문하기</button>
        </div>
      </div>
    </div>

    <div id="view-quotation" style="display:none;">
      <div style="max-width:1200px; margin:0 auto; padding:20px;">

        <div style="display:grid; grid-template-columns:280px 1fr 340px; gap:20px; align-items:start;">
          
          <div>
            <div style="border-radius:12px; overflow:hidden; border:1px solid var(--line); background:#ffffff; aspect-ratio:1 / 1; position:relative;">
              <img
                id="quote-indigo-img"
                src=""
                alt="인디고"
                style="width:100%; height:100%; object-fit:contain; display:none; background:#ffffff;"
              >
              <div class="img-placeholder" style="position:absolute; top:0; left:0; width:100%; height:100%; display:flex; align-items:center; justify-content:center; background:#f1f5f9; color:#64748b; font-size:18px; font-weight:700;">No Image</div>
            </div>
            
            </div>

          <div>
            <div style="padding:0;">
              <div style="padding-bottom:18px; margin-bottom:18px; border-bottom:2px solid #e2e8f0;">
                <div style="font-weight:800; font-size:16px; margin-bottom:16px; color:var(--text); border-left:4px solid var(--primary); padding-left:12px;">기본 사양</div>
                
                  <div>
                  <div style="margin-bottom:16px;">
                    <div style="display:flex; align-items:center; gap:12px; margin-bottom:8px;">
                      <label style="font-weight:700; font-size:13px; color:#475569; margin:0; min-width:60px;">사이즈</label>
                      <select id="ind-bookSize-standard" onchange="updateSizeFromStandard()" style="flex:1; max-width:250px; padding:8px 10px; border:1px solid #cbd5e1; border-radius:8px; background:#f8fafc; font-size:12px; font-weight:600;">
                        <option value="210×297">A4</option>
                        <option value="182×257">B5</option>
                        <option value="148×210">A5</option>
                        <option value="custom">사이즈입력</option>
                      </select>
                    </div>
                    
                    <div id="size-cutting-container" style="display:flex; align-items:center; gap:8px; margin-bottom:6px;">
                      <input type="radio" name="size-type" value="cutting" id="size-cutting" checked style="width:16px; height:16px; cursor:pointer;">
                      <label for="size-cutting" style="font-size:12px; color:#64748b; cursor:pointer; margin:0; min-width:70px;">재단사이즈</label>
                      <div style="display:flex; align-items:center; gap:4px;">
                        <input type="number" id="ind-size-width" value="210" style="width:70px; padding:6px 8px; border:1px solid #cbd5e1; border-radius:6px; background:#f8fafc; font-size:12px; font-weight:600; text-align:center;">
                        <span style="font-size:12px; font-weight:700; color:#64748b;">X</span>
                        <input type="number" id="ind-size-height" value="297" style="width:70px; padding:6px 8px; border:1px solid #cbd5e1; border-radius:6px; background:#f8fafc; font-size:12px; font-weight:600; text-align:center;">
                        <span style="font-size:11px; font-weight:600; color:#64748b; margin-left:4px;">mm</span>
                      </div>
                    </div>
                    
                    <div style="display:flex; align-items:center; gap:8px;">
                      <input type="radio" name="size-type" value="working" id="size-working" disabled style="width:16px; height:16px; cursor:not-allowed; opacity:0.5;">
                      <label for="size-working" style="font-size:12px; color:#94a3b8; cursor:not-allowed; margin:0; min-width:70px;">작업사이즈</label>
                      <div style="display:flex; align-items:center; gap:4px;">
                        <input type="number" id="ind-size-working-width" value="214" disabled style="width:70px; padding:6px 8px; border:1px solid #e2e8f0; border-radius:6px; background:#f1f5f9; font-size:12px; font-weight:600; text-align:center; color:#94a3b8; cursor:not-allowed;">
                        <span style="font-size:12px; font-weight:700; color:#94a3b8;">X</span>
                        <input type="number" id="ind-size-working-height" value="301" disabled style="width:70px; padding:6px 8px; border:1px solid #e2e8f0; border-radius:6px; background:#f1f5f9; font-size:12px; font-weight:600; text-align:center; color:#94a3b8; cursor:not-allowed;">
                        <span style="font-size:11px; font-weight:600; color:#94a3b8; margin-left:4px;">mm</span>
                      </div>
                    </div>
                  </div>

                  <div style="margin-bottom:16px;">
                    <div style="display:flex; align-items:center; gap:12px; margin-bottom:8px;">
                      <label style="font-weight:700; font-size:13px; color:#475569; margin:0; min-width:60px;">수량</label>
                      <div style="display:flex; align-items:center; gap:4px;">
                        <button type="button" onclick="changeQty(-1)" style="width:32px; height:32px; border:1px solid #cbd5e1; border-radius:6px; background:#fff; cursor:pointer; font-size:16px; font-weight:700; color:#64748b; display:flex; align-items:center; justify-content:center;">-</button>
                        <input type="number" id="ind-qty" value="" placeholder="0" style="width:80px; padding:8px 10px; border:1px solid #cbd5e1; border-radius:6px; background:#f8fafc; font-size:12px; font-weight:600; text-align:center;">
                        <button type="button" onclick="changeQty(1)" style="width:32px; height:32px; border:1px solid #cbd5e1; border-radius:6px; background:#fff; cursor:pointer; font-size:16px; font-weight:700; color:#64748b; display:flex; align-items:center; justify-content:center;">+</button>
                      </div>
                    </div>
                    <div style="display:flex; gap:6px; margin-left:72px;">
                      <button type="button" onclick="quickAddQty(1)" style="padding:6px 12px; border:1px solid #cbd5e1; border-radius:6px; background:#fff; cursor:pointer; font-size:11px; font-weight:600; color:#64748b; transition:all 0.2s;">+ 1부</button>
                      <button type="button" onclick="quickAddQty(10)" style="padding:6px 12px; border:1px solid #cbd5e1; border-radius:6px; background:#fff; cursor:pointer; font-size:11px; font-weight:600; color:#64748b; transition:all 0.2s;">+ 10부</button>
                      <button type="button" onclick="quickAddQty(100)" style="padding:6px 12px; border:1px solid #cbd5e1; border-radius:6px; background:#fff; cursor:pointer; font-size:11px; font-weight:600; color:#64748b; transition:all 0.2s;">+ 100부</button>
                    </div>
                  </div>

                  <div id="ind-area-binding-direction">
                    <div style="display:flex; align-items:center; gap:12px;">
                      <label style="font-weight:700; font-size:13px; color:#475569; margin:0; min-width:60px;">제본방향</label>
                      <select id="ind-binding-direction" style="flex:1; max-width:250px; padding:8px 10px; border:1px solid #cbd5e1; border-radius:8px; background:#f8fafc; font-size:12px; font-weight:600;">
                        <option value="vertical-left">세로형좌철</option>
                        <option value="vertical-right">세로형우철</option>
                        <option value="horizontal-top">가로형상철</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>

              <div style="padding-bottom:18px; margin-bottom:18px; border-bottom:2px solid #e2e8f0;">
                <div style="font-weight:800; font-size:16px; margin-bottom:16px; color:var(--text); border-left:4px solid var(--primary); padding-left:12px;">용지/인쇄</div>
                
                <div id="ind-paper-print-container" style="display:grid; grid-template-columns:1fr 1px 1fr; gap:20px; align-items:start;">
                  <div id="ind-area-cover">
                    <div style="font-weight:700; font-size:14px; margin-bottom:12px; color:#1e293b; border-bottom:2px solid var(--primary); padding-bottom:6px;" id="ind-title-cover">표지선택</div>
                    
                    <div style="margin-bottom:10px;">
                      <label style="font-size:12px; color:#64748b; display:block; margin-bottom:6px; font-weight:700;">용지 상세</label>
                      <div style="display:flex; gap:8px;">
                        <select id="ind-coverType" onchange="updateIndGram('cover')" style="flex:1; padding:8px 10px; border:1px solid #cbd5e1; border-radius:8px; background:#f8fafc; font-size:12px; font-weight:600;"></select>
                        <select id="ind-coverGram" style="width:100px; padding:8px 10px; border:1px solid #cbd5e1; border-radius:8px; background:#f8fafc; font-size:12px; font-weight:600;"></select>
                      </div>
                    </div>

                    <div style="margin-bottom:10px;">
                      <label style="font-size:12px; color:#64748b; display:block; margin-bottom:6px; font-weight:700;">인쇄 상세</label>
                      <select id="ind-coverPrint-select" style="width:100%; padding:8px 10px; border:1px solid #cbd5e1 !important; border-radius:8px; background:#f8fafc; font-size:12px; font-weight:600; outline:none !important; box-shadow:none !important;" onfocus="this.style.borderColor='#cbd5e1'; this.style.outline='none'; this.style.boxShadow='none';" onblur="this.style.borderColor='#cbd5e1'; this.style.outline='none'; this.style.boxShadow='none';">
                        <option value="2-color">양면 컬러</option>
                        <option value="2-mono">양면 흑백</option>
                        <option value="1-color">단면 컬러</option>
                        <option value="1-mono">단면 흑백</option>
                      </select>
                      <input type="radio" name="ind-coverPrint" value="1" id="ind-coverPrint-1" style="display:none;">
                      <input type="radio" name="ind-coverPrint" value="2" id="ind-coverPrint-2" checked style="display:none;">
                      <input type="radio" name="ind-coverColor" value="color" id="ind-coverColor-color" checked style="display:none;">
                      <input type="radio" name="ind-coverColor" value="mono" id="ind-coverColor-mono" style="display:none;">
                    </div>

                    <div style="margin-bottom:10px;">
                      <label style="font-size:12px; color:#64748b; display:block; margin-bottom:6px; font-weight:700;">페이지</label>
                      <select id="ind-coverPages" style="width:100%; padding:8px 10px; border:1px solid #cbd5e1; border-radius:8px; background:#f8fafc; font-size:12px; font-weight:600;">
                        <option value="" selected>페이지선택</option>
                        <option value="2">2p</option>
                        <option value="4">4p</option>
                      </select>
                    </div>

                    <div>
                      <label style="font-size:12px; color:#64748b; display:block; margin-bottom:6px; font-weight:700;">코팅 상세</label>
                      <select id="ind-coating-select" style="width:100%; padding:8px 10px; border:1px solid #cbd5e1; border-radius:8px; background:#f8fafc; font-size:12px; font-weight:600;">
                        <option value="0" selected>코팅없음</option>
                        <option value="1">단면무광코팅</option>
                        <option value="3">단면유광코팅</option>
                      </select>
                      <input type="radio" name="ind-coat" value="0" id="ind-coat-0" checked style="display:none;">
                      <input type="radio" name="ind-coat" value="1" id="ind-coat-1" style="display:none;">
                    </div>
                  </div>

                  <div id="ind-paper-print-divider" style="background:#e2e8f0; width:1px; height:100%;"></div>

                  <div id="ind-area-inner">
                    <div style="font-weight:700; font-size:14px; margin-bottom:12px; color:#1e293b; border-bottom:2px solid var(--primary); padding-bottom:6px;" id="ind-title-inner">내지선택</div>
                    
                    <div style="margin-bottom:10px;">
                      <label style="font-size:12px; color:#64748b; display:block; margin-bottom:6px; font-weight:700;">용지 상세</label>
                      <div style="display:flex; gap:8px;">
                        <select id="ind-innerType" onchange="updateIndGram('inner')" style="flex:1; padding:8px 10px; border:1px solid #cbd5e1; border-radius:8px; background:#f8fafc; font-size:12px; font-weight:600;"></select>
                        <select id="ind-innerGram" style="width:100px; padding:8px 10px; border:1px solid #cbd5e1; border-radius:8px; background:#f8fafc; font-size:12px; font-weight:600;"></select>
                      </div>
                    </div>

                    <div style="margin-bottom:10px;">
                      <label style="font-size:12px; color:#64748b; display:block; margin-bottom:6px; font-weight:700;">인쇄 상세</label>
                      <select id="ind-innerPrint-select" style="width:100%; padding:8px 10px; border:1px solid #cbd5e1 !important; border-color:#cbd5e1 !important; border-radius:8px; background:#f8fafc; font-size:12px; font-weight:600; outline:none !important; box-shadow:none !important;" onfocus="this.style.setProperty('border-color', '#cbd5e1', 'important'); this.style.setProperty('outline', 'none', 'important'); this.style.setProperty('box-shadow', 'none', 'important'); this.style.setProperty('border', '1px solid #cbd5e1', 'important');" onblur="this.style.setProperty('border-color', '#cbd5e1', 'important'); this.style.setProperty('outline', 'none', 'important'); this.style.setProperty('box-shadow', 'none', 'important'); this.style.setProperty('border', '1px solid #cbd5e1', 'important');" onmousedown="this.style.setProperty('border-color', '#cbd5e1', 'important');" onmouseup="this.style.setProperty('border-color', '#cbd5e1', 'important');">
                        <option value="2-color">양면 컬러</option>
                        <option value="2-mono">양면 흑백</option>
                        <option value="1-color">단면 컬러</option>
                        <option value="1-mono">단면 흑백</option>
                      </select>
                      <input type="radio" name="ind-innerPrint" value="1" id="ind-innerPrint-1" style="display:none;">
                      <input type="radio" name="ind-innerPrint" value="2" id="ind-innerPrint-2" checked style="display:none;">
                      <input type="radio" name="ind-innerColor" value="color" id="ind-innerColor-color" checked style="display:none;">
                      <input type="radio" name="ind-innerColor" value="mono" id="ind-innerColor-mono" style="display:none;">
                    </div>

                    <div id="ind-area-inner-pages">
                      <label style="font-size:12px; color:#64748b; display:block; margin-bottom:6px; font-weight:700;">페이지</label>
                      <select id="ind-innerPages" style="width:100%; padding:8px 10px; border:1px solid #cbd5e1; border-radius:8px; background:#f8fafc; font-size:12px; font-weight:600;">
                        </select>
                    </div>
                  </div>
                </div>
              </div>

              <div id="ind-area-binding" style="padding-bottom:18px; margin-bottom:18px; border-bottom:2px solid #e2e8f0;">
                <div style="font-weight:800; font-size:16px; margin-bottom:16px; color:var(--text); border-left:4px solid var(--primary); padding-left:12px;">후가공</div>
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:16px;">
                  <div>
                    <label style="display:block; font-weight:700; font-size:13px; margin-bottom:8px; color:#475569;">제본 방식</label>
                    <div style="display:flex; gap:10px;">
                      <label style="flex:1; padding:10px 14px; border:2px solid var(--primary); border-radius:6px; background:#ecfdf5; cursor:pointer; font-size:13px; text-align:center; color:var(--primary); font-weight:600;">
                        <input type="radio" name="ind-bind" value="perfect" style="display:none;"> 무선
                      </label>
                      <label style="flex:1; padding:10px 14px; border:1px solid #cbd5e1; border-radius:6px; background:#fff; cursor:pointer; font-size:13px; text-align:center;">
                        <input type="radio" name="ind-bind" value="staple" checked style="display:none;"> 중철
                      </label>
                    </div>
                  </div>
                </div>
              </div>

              <!-- 마진율 입력: 관리자에서만 관리, 고객 화면에서는 숨김 -->
              <div style="margin-top:18px; margin-bottom:18px; display:none;">
                <label style="display:block; font-weight:700; font-size:13px; margin-bottom:8px; color:#475569;">마진율 (%)</label>
                <input type="number" id="ind-margin" value="30" style="width:100%; padding:12px; border:1px solid #cbd5e1; border-radius:8px; background:#f8fafc; font-size:14px; font-weight:600;">
              </div>

              <div style="margin-top:18px;">
                <button class="btn btn-primary" onclick="calculateIndigo()" style="width:100%; padding:14px; font-size:15px; font-weight:700;">견적 계산하기</button>
              </div>
            </div>
          </div>

          <div style="position:sticky; top:70px; height:fit-content; align-self:start;">
            <div style="background:#1a2332; color:#fff; border-radius:16px; padding:20px; box-shadow:0 10px 30px rgba(0,0,0,0.2);">
              <div style="font-weight:700; font-size:13px; margin-bottom:20px; color:#cbd5e1;">견적 요약서</div>
              
              <div style="display:flex; justify-content:space-between; margin-bottom:12px; font-size:13px; color:#cbd5e1;">
                <span>카테고리</span>
                <strong style="color:#f8fafc;" id="sum-cat">-</strong>
              </div>
              <div style="display:flex; justify-content:space-between; margin-bottom:12px; font-size:13px; color:#cbd5e1;">
                <span>수량</span>
                <strong style="color:#f8fafc;" id="sum-qty">-</strong>
              </div>
              <div style="display:flex; justify-content:space-between; margin-bottom:12px; font-size:13px; color:#cbd5e1;">
                <span>공급가</span>
                <strong style="color:#f8fafc;" id="sum-supply">-</strong>
              </div>
              <div style="display:flex; justify-content:space-between; margin-bottom:12px; font-size:13px; color:#cbd5e1;">
                <span>부가세</span>
                <strong style="color:#f8fafc;" id="sum-vat">-</strong>
              </div>
              <div style="display:flex; justify-content:space-between; padding:12px 0; border-top:1px dashed rgba(203,213,227,.2); border-bottom:1px dashed rgba(203,213,227,.2); margin-bottom:16px; font-size:13px; color:#cbd5e1;">
                <span>배송비</span>
                <strong style="color:#f8fafc;" id="sum-ship">-</strong>
              </div>
              
              <div style="text-align:center; padding:12px; background:rgba(16,185,129,.1); border-radius:8px; margin-bottom:18px;">
                <div style="font-size:11px; color:#cbd5e1; margin-bottom:4px;">최종 합계</div>
                <div style="font-size:28px; font-weight:900; color:#10b981;" id="sum-total">0원</div>
              </div>

              <button id="btn-add-to-cart" class="btn btn-primary" style="width:100%; padding:12px; margin-bottom:8px; font-weight:700;" onclick="addToCartFromQuote()">장바구니</button>
              <button id="btn-order-now" class="btn" style="width:100%; padding:12px; background:#10b981; color:#fff; border:none; font-weight:700;" onclick="orderDirectlyFromQuote()">바로주문하기</button>
            </div>

            <div style="background:#1a2332; color:#fff; border-radius:16px; padding:20px; box-shadow:0 10px 30px rgba(0,0,0,0.2); margin-top:16px;">
              <div style="font-weight:700; font-size:13px; margin-bottom:12px; color:#cbd5e1;">📎 파일 첨부</div>
              <div style="font-size:11px; color:#94a3b8; margin-bottom:10px;">인쇄할 파일을 첨부하세요 (PDF, AI, PSD 등)</div>
              
              <input type="file" id="quote-file-input" multiple accept=".pdf,.ai,.psd,.jpg,.jpeg,.png,.zip" style="display:none;" onchange="handleQuoteFileUpload(event)">
              <button onclick="document.getElementById('quote-file-input').click()" style="width:100%; padding:10px; background:#334155; color:#cbd5e1; border:1px dashed #475569; border-radius:8px; cursor:pointer; font-size:12px; font-weight:600; transition:all 0.3s;">
                📁 파일 선택하기
              </button>
              
              <div id="quote-file-list" style="margin-top:10px; max-height:150px; overflow-y:auto;"></div>
            </div>
          </div>

        </div>
      </div>

      
    </div>

    <div id="view-cs" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.5); display:none; align-items:center; justify-content:center; z-index:2000;">
      <div class="card" style="max-width:500px; width:90%; max-height:80vh; overflow-y:auto;">
        <div style="padding:14px 18px; border-bottom:1px solid var(--line); font-weight:1100; background:#f8fbff; display:flex; justify-content:space-between; align-items:center;">
          고객센터
          <button onclick="hideCS()" style="border:none; background:none; font-size:20px; cursor:pointer;">✕</button>
        </div>
        <div style="padding:18px;">
          <h3 style="font-weight:1100; margin:0 0 12px 0; border-left:4px solid var(--primary); padding-left:8px;">문의 안내</h3>
          <div style="background:#f8fafc; border-radius:14px; padding:16px; margin-bottom:20px;">
            <div style="display:flex; align-items:center; gap:12px; margin-bottom:10px;">
              <span style="font-size:20px;">☎️</span>
              <div>
                <p style="margin:0; font-weight:1100; color:#0f172a;">전화 상담</p>
                <p style="margin:4px 0 0 0; font-size:12px; color:#64748b;">1688-4152</p>
              </div>
            </div>
            <div style="font-size:12px; color:#64748b; margin-top:12px;">
              <p style="margin:0; font-weight:600;">운영시간</p>
              <p style="margin:4px 0 0 0;">월~금: 09:00 ~ 18:30</p>
              <p style="margin:2px 0 0 0;">토·일·공휴일: 휴무</p>
            </div>
          </div>

          <h3 style="font-weight:1100; margin:0 0 12px 0; border-left:4px solid var(--primary); padding-left:8px;">자주 묻는 질문</h3>
          <div style="display:flex; flex-direction:column; gap:8px;">
            <div onclick="toast('상세 답변 준비중')" style="padding:12px; border:1px solid var(--line); border-radius:8px; cursor:pointer; transition:.15s; background:#fff;" onmouseover="this.style.background='#f8fafc'" onmouseout="this.style.background='#fff'">
              <p style="margin:0; font-weight:700; font-size:13px; color:#0f172a;">배송은 얼마나 걸리나요?</p>
              <p style="margin:4px 0 0 0; font-size:12px; color:#64748b;">일반적으로 2~3일 소요됩니다.</p>
            </div>
            <div onclick="toast('상세 답변 준비중')" style="padding:12px; border:1px solid var(--line); border-radius:8px; cursor:pointer; transition:.15s; background:#fff;" onmouseover="this.style.background='#f8fafc'" onmouseout="this.style.background='#fff'">
              <p style="margin:0; font-weight:700; font-size:13px; color:#0f172a;">파일 형식은 어떻게 되나요?</p>
              <p style="margin:4px 0 0 0; font-size:12px; color:#64748b;">PDF, AI, PSD 등을 지원합니다.</p>
            </div>
            <div onclick="toast('상세 답변 준비중')" style="padding:12px; border:1px solid var(--line); border-radius:8px; cursor:pointer; transition:.15s; background:#fff;" onmouseover="this.style.background='#f8fafc'" onmouseout="this.style.background='#fff'">
              <p style="margin:0; font-weight:700; font-size:13px; color:#0f172a;">환불은 어떻게 하나요?</p>
              <p style="margin:4px 0 0 0; font-size:12px; color:#64748b;">배송 전 환불 가능합니다.</p>
            </div>
          </div>

          <h3 style="font-weight:1100; margin:20px 0 12px 0; border-left:4px solid var(--primary); padding-left:8px;">문의 남기기</h3>
          <textarea placeholder="문의 내용을 입력해주세요..." id="cs-message" style="width:100%; height:100px; padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px; resize:none; margin-bottom:10px;"></textarea>
          <button class="btn btn-primary" onclick="submitCS()">문의 전송</button>
        </div>
      </div>
    </div>

    <div id="view-notice" style="display:none;">
      <div style="max-width:900px; margin:40px auto;">
        
        <!-- 공지사항 목록 모드 -->
        <div id="notice-list-mode">
          <div class="card">
            <div style="padding:24px; border-bottom:1px solid var(--line);">
              <h2 style="margin:0; font-weight:700; font-size:20px; color:#0f172a;">📢 공지사항</h2>
            </div>
            <div id="notice-list-container" style="padding:16px;">
              <!-- JavaScript로 렌더링 -->
            </div>
          </div>
        </div>

        <!-- 공지사항 상세 모드 -->
        <div id="notice-detail-mode" style="display:none;">
          <div class="card">
            <div style="padding:24px; border-bottom:1px solid var(--line);">
              <button class="btn" style="background:#e2e8f0; color:#475569; border:none; padding:8px 16px; font-size:13px; margin-bottom:16px;" onclick="backToNoticeList()">← 목록으로</button>
              <h2 id="notice-detail-title" style="margin:0 0 8px 0; font-weight:700; font-size:20px; color:#0f172a;"></h2>
              <div id="notice-detail-meta" style="font-size:13px; color:#64748b;"></div>
            </div>
            <div style="padding:24px;">
              <div id="notice-detail-content" style="font-size:14px; line-height:1.7; color:#334155; white-space:pre-wrap;"></div>
            </div>
          </div>
        </div>

      </div>
    </div>

    <div id="view-admin" style="display:none;">
      <div style="max-width:600px; margin:40px auto; text-align:center;">
        <div class="card" style="background:#f8fbff; border:2px solid var(--home-primary);">
          <div style="padding:30px 18px;">
            <h2 style="margin:0 0 10px 0; color:var(--home-primary);">🛠️ 관리자 로그인</h2>
            <p style="margin:0 0 20px 0; color:#64748b; font-size:13px;">관리자 비밀번호를 입력해주세요</p>
            
            <input type="password" id="admin-pw" placeholder="비밀번호 (1234)" style="width:100%; padding:12px; border:1px solid #cbd5e1; border-radius:8px; background:#fff; font-size:14px; margin-bottom:14px;">
            
            <button class="btn btn-primary" onclick="adminLogin()">관리자 접속</button>
            <button class="btn" style="background:#e2e8f0; color:#64748b; border:none; margin-top:8px;" onclick="goHome()">뒤로가기</button>
          </div>
        </div>
      </div>

      <div id="admin-panel" style="display:none; max-width:1600px; margin:20px auto; padding:0 20px;">
        <div style="display:flex; gap:10px; margin-bottom:20px; flex-wrap:wrap;">
          <button class="btn" style="background:var(--home-primary); color:#fff; border:none; flex:1; min-width:150px;" onclick="showAdminTab('adm-orders')">📊 주문 관리</button>
          <button class="btn" style="background:#64748b; color:#fff; border:none; flex:1; min-width:150px;" onclick="showAdminTab('adm-content')">📝 상품 관리</button>
          <button class="btn" style="background:#64748b; color:#fff; border:none; flex:1; min-width:150px;" onclick="showAdminTab('adm-users')">👥 회원 관리</button>
          <button class="btn" style="background:#10b981; color:#fff; border:none; flex:1; min-width:150px;" onclick="showAdminTab('adm-payment-links')">💳 개인결제 링크</button>
          <button class="btn" style="background:#3b82f6; color:#fff; border:none; flex:1; min-width:150px;" onclick="showAdminTab('adm-homepage')">🏠 홈페이지 관리</button>
          <button class="btn" style="background:#f59e0b; color:#fff; border:none; flex:1; min-width:150px;" onclick="showAdminTab('adm-popup')">📢 팝업 관리</button>
          <button class="btn" style="background:#8b5cf6; color:#fff; border:none; flex:1; min-width:150px;" onclick="showAdminTab('adm-notice')">📋 공지사항 관리</button>
          <button class="btn" style="background:#ef4444; color:#fff; border:none; flex:1; min-width:150px;" onclick="resetAllData()">🔄 데이터 초기화</button>
          <button class="btn" style="background:#64748b; color:#fff; border:none; flex:1; min-width:150px;" onclick="adminLogout()">로그아웃</button>
        </div>

        <div id="adm-orders" class="card">
          <div style="padding:16px; border-bottom:1px solid var(--line); background:#f8fafc; font-weight:1000;">📊 접수된 주문 리스트</div>
          
          <!-- 날짜 필터 섹션 -->
          <div style="padding:12px 18px; border-bottom:1px solid var(--line); background:#fafafa;">
            <div style="font-size:13px; font-weight:700; color:#0f172a; margin-bottom:8px;">조회기간</div>
            <div style="display:inline-flex; gap:3px; margin-bottom:12px;">
              <button class="btn" style="background:#037a3f; color:#fff; padding:3px 8px; font-size:11px; border:none; border-radius:4px; cursor:pointer; white-space:nowrap;" onclick="setAdminOrderDateRange('today')">오늘</button>
              <button class="btn" style="background:#0f7ba7; color:#fff; padding:3px 8px; font-size:11px; border:none; border-radius:4px; cursor:pointer; white-space:nowrap;" onclick="setAdminOrderDateRange('week')">1주일</button>
              <button class="btn" style="background:#6b5b95; color:#fff; padding:3px 8px; font-size:11px; border:none; border-radius:4px; cursor:pointer; white-space:nowrap;" onclick="setAdminOrderDateRange('month')">1개월</button>
              <button class="btn" style="background:#8b4513; color:#fff; padding:3px 8px; font-size:11px; border:none; border-radius:4px; cursor:pointer; white-space:nowrap;" onclick="setAdminOrderDateRange('all')">전체</button>
            </div>
            <div style="display:inline-flex; gap:6px; align-items:center; margin-bottom:12px;">
              <label style="font-size:11px; color:#64748b; white-space:nowrap;">시작:</label>
              <input type="date" id="admin-order-date-from" style="padding:4px 4px; border:1px solid #cbd5e1; border-radius:4px; font-size:10px; width:100px;">
              <label style="font-size:11px; color:#64748b; white-space:nowrap;">종료:</label>
              <input type="date" id="admin-order-date-to" style="padding:4px 4px; border:1px solid #cbd5e1; border-radius:4px; font-size:10px; width:100px;">
              <button onclick="applyAdminOrderDateFilter()" class="btn" style="background:#0891b2; color:#fff; padding:2px 6px; font-size:10px; border:none; border-radius:3px; cursor:pointer; white-space:nowrap;">필터</button>
            </div>
            
            <!-- 주문 상태별 통계 -->
            <div style="display:flex; gap:30px; flex-wrap:wrap; justify-content:space-around; padding:24px 0; width:100%;">
              <div style="display:flex; flex-direction:column; align-items:center; gap:12px; cursor:pointer; flex:0 1 auto;" onclick="filterAdminOrderByStatus('pending')">
                <div style="width:80px; height:80px; background:#f59e0b; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:36px; font-weight:bold; color:#fff; box-shadow:0 4px 12px rgba(0,0,0,0.15); transition:transform 0.2s, box-shadow 0.2s;" onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 6px 16px rgba(0,0,0,0.2)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.15)';">📦</div>
                <div style="text-align:center;">
                  <div style="font-size:12px; color:#64748b; font-weight:600;">신규주문접수</div>
                  <div style="font-size:16px; font-weight:bold; color:#0f172a;" id="stat-pending">0건</div>
                </div>
              </div>
              <div style="display:flex; flex-direction:column; align-items:center; gap:12px; cursor:pointer; flex:0 1 auto;" onclick="filterAdminOrderByStatus('preparing')">
                <div style="width:80px; height:80px; background:#3b82f6; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:36px; font-weight:bold; color:#fff; box-shadow:0 4px 12px rgba(0,0,0,0.15); transition:transform 0.2s, box-shadow 0.2s;" onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 6px 16px rgba(0,0,0,0.2)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.15)';">⚙️</div>
                <div style="text-align:center;">
                  <div style="font-size:12px; color:#64748b; font-weight:600;">준비중</div>
                  <div style="font-size:16px; font-weight:bold; color:#0f172a;" id="stat-preparing">0건</div>
                </div>
              </div>
              <div style="display:flex; flex-direction:column; align-items:center; gap:12px; cursor:pointer; flex:0 1 auto;" onclick="filterAdminOrderByStatus('shipping')">
                <div style="width:80px; height:80px; background:#8b5cf6; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:36px; font-weight:bold; color:#fff; box-shadow:0 4px 12px rgba(0,0,0,0.15); transition:transform 0.2s, box-shadow 0.2s;" onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 6px 16px rgba(0,0,0,0.2)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.15)';">🚚</div>
                <div style="text-align:center;">
                  <div style="font-size:12px; color:#64748b; font-weight:600;">배송진행</div>
                  <div style="font-size:16px; font-weight:bold; color:#0f172a;" id="stat-shipping">0건</div>
                </div>
              </div>
              <div style="display:flex; flex-direction:column; align-items:center; gap:12px; cursor:pointer; flex:0 1 auto;" onclick="filterAdminOrderByStatus('completed')">
                <div style="width:80px; height:80px; background:#10b981; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:36px; font-weight:bold; color:#fff; box-shadow:0 4px 12px rgba(0,0,0,0.15); transition:transform 0.2s, box-shadow 0.2s;" onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 6px 16px rgba(0,0,0,0.2)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.15)';">✓</div>
                <div style="text-align:center;">
                  <div style="font-size:12px; color:#64748b; font-weight:600;">배송완료</div>
                  <div style="font-size:16px; font-weight:bold; color:#0f172a;" id="stat-completed">0건</div>
                </div>
              </div>
            </div>
          </div>
          
          <div style="padding:18px; border-bottom:1px solid var(--line);">
            <div style="display:flex; gap:10px; align-items:center;">
              <input type="text" id="adm-order-search" placeholder="주문번호 또는 고객명 검색..." style="flex:1; padding:10px; border-radius:8px; border:1px solid #cbd5e1; background:#f8fafc; font-size:13px;">
              <button onclick="searchAdminOrders()" class="btn" style="background:var(--home-primary); color:#fff; border:none; padding:10px 20px; border-radius:8px; font-weight:600; cursor:pointer;">검색</button>
              <button onclick="get('adm-order-search').value=''; searchAdminOrders();" class="btn" style="background:#e2e8f0; color:#64748b; border:none; padding:10px 20px; border-radius:8px; font-weight:600; cursor:pointer;">초기화</button>
            </div>
          </div>
          <div style="padding:18px; overflow-x:auto;">
            <table style="width:100%; border-collapse:collapse; font-size:13px;">
              <thead>
                <tr style="background:#f8fafc; border-bottom:2px solid var(--line);">
                  <th style="padding:10px; text-align:left; font-weight:1000;">주문번호</th>
                  <th style="padding:10px; text-align:left; font-weight:1000;">주문일</th>
                  <th style="padding:10px; text-align:left; font-weight:1000;">주문자</th>
                  <th style="padding:10px; text-align:left; font-weight:1000;">내용</th>
                  <th style="padding:10px; text-align:left; font-weight:1000;">금액</th>
                  <th style="padding:10px; text-align:center; font-weight:1000;">관리</th>
                </tr>
              </thead>
              <tbody id="order-list-body">
                <tr><td colspan="6" style="padding:30px; text-align:center; color:#64748b;">주문을 불러오는 중입니다...</td></tr>
              </tbody>
            </table>
          </div>
        </div>

        <div id="adm-content" style="display:none;" class="card">
          <div style="padding:20px; border-bottom:1px solid var(--line); background:#f8fafc;">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:16px;">
              <span style="font-weight:1000; font-size:16px;">🛒 상품 관리</span>
              <div style="display:flex; gap:10px; align-items:center;">
                <button onclick="applyContentToDetailTabs(get('adm-cat-select')?.value || window.currentCategory)" class="btn" style="background:#e2e8f0; color:#475569;">미리보기 적용</button>
                <button onclick="goHome()" style="border:none; background:none; font-size:12px; color:#64748b; cursor:pointer; text-decoration:underline;">내 쇼핑몰 미리보기</button>
              </div>
            </div>

            <!-- 카테고리 탭 -->
            <div style="display:flex; gap:6px; flex-wrap:wrap; align-items:center;">
              <button class="btn adm-cat-btn" onclick="document.getElementById('adm-cat-select').value='indigo'; loadAdminContent();" style="padding:6px 12px; font-size:11px; background:#fff; border:1px solid #e2e8f0; border-radius:6px; font-weight:600; transition:all 0.2s; white-space:nowrap; width:auto;">📘 소량 인디고</button>
              <button class="btn adm-cat-btn" onclick="document.getElementById('adm-cat-select').value='digital'; loadAdminContent();" style="padding:6px 12px; font-size:11px; background:#fff; border:1px solid #e2e8f0; border-radius:6px; font-weight:600; transition:all 0.2s; white-space:nowrap; width:auto;">⚫ 흑백 디지털</button>
              <button class="btn adm-cat-btn" onclick="document.getElementById('adm-cat-select').value='offset'; loadAdminContent();" style="padding:6px 12px; font-size:11px; background:#fff; border:1px solid #e2e8f0; border-radius:6px; font-weight:600; transition:all 0.2s; white-space:nowrap; width:auto;">📗 대량 옵셋</button>
              <button class="btn adm-cat-btn" onclick="document.getElementById('adm-cat-select').value='flyer_small'; loadAdminContent();" style="padding:6px 12px; font-size:11px; background:#fff; border:1px solid #e2e8f0; border-radius:6px; font-weight:600; transition:all 0.2s; white-space:nowrap; width:auto;">📄 소량 전단</button>
              <button class="btn adm-cat-btn" onclick="document.getElementById('adm-cat-select').value='flyer_large'; loadAdminContent();" style="padding:6px 12px; font-size:11px; background:#fff; border:1px solid #e2e8f0; border-radius:6px; font-weight:600; transition:all 0.2s; white-space:nowrap; width:auto;">📋 대량 전단</button>
            </div>
          </div>

          <div style="padding:32px; max-width:1400px; margin:0 auto;">
            <!-- 2단 레이아웃: 에디터(넓게) + 미리보기 -->
            <div style="display:grid; grid-template-columns:1fr 340px; gap:28px; align-items:start;">
              
              <!-- Left: Editor (넓어진 에디터 영역) -->
              <section style="background:#fff; border:1px solid var(--line); border-radius:12px; padding:28px; box-shadow:0 2px 8px rgba(0,0,0,0.04);">
                <div style="display:flex; gap:12px; align-items:center; margin-bottom:24px; padding-bottom:20px; border-bottom:2px solid #f1f5f9; flex-wrap:wrap;">
                  <label style="font-weight:700; font-size:12px; color:#475569; white-space:nowrap; line-height:1.5;">편집 상품:</label>
                  <select id="adm-cat-select" onchange="loadAdminContent()" style="padding:8px 12px; border:1px solid #cbd5e1; border-radius:8px; font-weight:600; font-size:12px; min-width:100px;">
                    <option value="indigo">소량 인디고</option>
                    <option value="digital">흑백 디지털</option>
                    <option value="offset">대량 옵셋</option>
                    <option value="flyer_small">소량 전단</option>
                    <option value="flyer_large">대량 전단</option>
                  </select>

                  <div id="binding-select-wrapper" style="display:flex; gap:12px; align-items:center;">
                    <label style="font-weight:700; font-size:12px; color:#475569; white-space:nowrap; line-height:1.5;">제본:</label>
                    <select id="adm-binding-select" onchange="loadAdminContent()" style="padding:8px 12px; border:1px solid #cbd5e1; border-radius:8px; font-weight:600; font-size:12px; min-width:80px;">
                      <option value="staple">중철</option>
                      <option value="perfect">무선</option>
                    </select>
                  </div>
                </div>

                <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px; margin-bottom:24px;">
                  <div>
                    <label style="display:block; font-size:13px; font-weight:700; margin-bottom:8px; color:#64748b;">💰 마진율 (%)</label>
                    <input type="number" id="adm-margin-val" placeholder="예: 100" style="width:100%; padding:12px; border:1px solid #cbd5e1; border-radius:8px; font-size:14px;">
                  </div>
                  <div>
                    <label style="display:block; font-size:13px; font-weight:700; margin-bottom:8px; color:#64748b;">🖼️ 대표 이미지</label>
                    <div style="display:flex; gap:10px; align-items:center;">
                      <input type="text" id="adm-img-url" placeholder="이미지 URL" style="flex:1; padding:12px; border:1px solid #cbd5e1; border-radius:8px; font-size:14px;">
                      <input type="file" id="adm-img-file" accept="image/*" style="display:none;" onchange="handleImageUpload(event)">
                      <button class="btn" onclick="document.getElementById('adm-img-file').click()" style="padding:12px 16px; background:#3b82f6; color:#fff; border:none; border-radius:8px; font-size:13px; white-space:nowrap; font-weight:600;">📁 업로드</button>
                    </div>
                    <div id="adm-img-preview-small" style="margin-top:12px; display:none; text-align:center;"><img id="adm-img-preview-img-small" style="width:100px; height:100px; object-fit:contain; border-radius:8px; border:1px solid #e2e8f0; background:#fff;"></div>
                  </div>
                </div>

                <div style="margin-bottom:24px;">
                  <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
                    <label style="font-weight:800; font-size:14px; color:#0f172a;">📝 상세설명 (HTML 에디터)</label>
                    <button class="btn" onclick="generateAIContent()" style="padding:8px 14px; font-size:13px; background:linear-gradient(135deg, #667eea 0%, #764ba2 100%); color:#fff; border:none; border-radius:6px; font-weight:600;">✨ AI 초안</button>
                  </div>
                  <div class="admin-editor-wrap"><textarea id="adm-info-txt"></textarea></div>
                </div>

                <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px; margin-bottom:24px;">
                  <div>
                    <label style="display:block; font-weight:700; font-size:13px; margin-bottom:8px; color:#64748b;">📋 제작 가이드</label>
                    <textarea id="adm-guide-txt" placeholder="파일 제작 시 주의사항을 입력하세요" style="width:100%; height:130px; padding:12px; border:1px solid #cbd5e1; border-radius:8px; font-size:14px; font-family:inherit; resize:vertical;"></textarea>
                  </div>
                  <div>
                    <label style="display:block; font-weight:700; font-size:13px; margin-bottom:8px; color:#64748b;">🚚 배송 안내</label>
                    <textarea id="adm-ship-txt" placeholder="배송 방법 및 소요 기간을 입력하세요" style="width:100%; height:130px; padding:12px; border:1px solid #cbd5e1; border-radius:8px; font-size:14px; font-family:inherit; resize:vertical;"></textarea>
                  </div>
                </div>

                <div style="display:flex; justify-content:center; gap:10px; margin-bottom:24px; padding-top:20px; border-top:2px solid #f1f5f9;">
                  <button class="btn btn-primary" onclick="saveAdminContent()" style="padding:12px 24px; font-size:14px; font-weight:700; white-space:nowrap; width:auto; line-height:1.5;">💾 저장</button>
                  <button class="btn" onclick="loadAdminContent()" style="padding:12px 20px; font-size:14px; background:#f1f5f9; border:1px solid #cbd5e1; white-space:nowrap; width:auto; line-height:1.5;">↩️ 취소</button>
                </div>
              </section>

              <!-- Right: 실시간 정보 표시 -->
              <aside style="background:#fff; border:1px solid var(--line); border-radius:12px; padding:24px; box-shadow:0 2px 8px rgba(0,0,0,0.04); position:sticky; top:20px;">
                <div style="font-weight:800; font-size:14px; margin-bottom:8px; color:#0f172a;">📊 편집 중인 상품</div>
                <div style="font-size:12px; color:#64748b; margin-bottom:18px; line-height:1.6;">저장 후 '미리보기 적용'을 눌러 실제 고객 화면에 반영하세요.</div>
                
                <div style="border:1px solid #e2e8f0; border-radius:12px; padding:18px; background:linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);">
                  <!-- 이미지 미리보기 -->
                  <div id="adm-img-preview" style="aspect-ratio: 1 / 1; overflow:hidden; display:flex; align-items:center; justify-content:center; background:#fff; border-radius:10px; border:1px dashed #cbd5e1; margin-bottom:16px;">
                    <img id="adm-img-preview-img" src="" alt="이미지를 업로드하거나 URL을 입력하세요" style="max-width:100%; max-height:100%; object-fit:contain; display:none;">
                    <span id="adm-img-placeholder" style="color:#94a3b8; font-size:13px; text-align:center; padding:20px;">🖼️<br>이미지 URL 입력 시<br>여기에 표시됩니다</span>
                  </div>
                  
                  <!-- 상품 정보 -->
                  <div id="adm-preview-title" style="font-weight:800; font-size:14px; color:#0f172a; margin-bottom:8px;">-</div>
                  <div id="adm-preview-binding" style="color:#64748b; font-size:13px; margin-bottom:12px;">제본: -</div>
                  
                  <!-- 통계 정보 -->
                  <div style="background:#fff; border-radius:8px; padding:12px; border:1px solid #e2e8f0;">
                    <div style="font-size:11px; color:#64748b; margin-bottom:8px; font-weight:600;">📝 입력 현황</div>
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:8px; font-size:12px;">
                      <div>
                        <span style="color:#64748b;">마진율:</span>
                        <span id="adm-stat-margin" style="font-weight:700; color:#0f172a;">-</span>
                      </div>
                      <div>
                        <span style="color:#64748b;">이미지:</span>
                        <span id="adm-stat-img" style="font-weight:700; color:#0f172a;">-</span>
                      </div>
                      <div>
                        <span style="color:#64748b;">상세설명:</span>
                        <span id="adm-stat-info" style="font-weight:700; color:#0f172a;">-</span>
                      </div>
                      <div>
                        <span style="color:#64748b;">가이드:</span>
                        <span id="adm-stat-guide" style="font-weight:700; color:#0f172a;">-</span>
                      </div>
                    </div>
                  </div>
                </div>
              </aside>
            </div>
          </div>
        </div>

        <div id="adm-homepage" style="display:none;" class="card">
          <div style="padding:16px; border-bottom:1px solid var(--line); background:#f8fafc; font-weight:1000;">🏠 홈페이지 컨텐츠</div>
          <div style="padding:18px; display:grid; gap:12px;">
            <div style="display:flex; justify-content:space-between; align-items:center;">
              <label style="font-weight:700;">메인 슬라이더 이미지</label>
              <button class="btn btn-primary" onclick="addSlide()" style="padding:6px 12px; font-size:12px;">+ 슬라이드 추가</button>
            </div>
            <div id="adm-slides-container" style="display:flex; gap:8px; flex-wrap:wrap;"></div>

            <label style="font-weight:700; margin-top:8px;">헤더 로고 (선택)</label>
            <div style="display:flex; gap:8px; align-items:center;">
              <img id="adm-home-logo-preview" src="" alt="로고" style="width:120px; height:36px; object-fit:contain; border:1px solid #e2e8f0; border-radius:8px; display:block; background:#fff;">
              <input type="file" id="adm-home-logo-file" accept="image/*" onchange="handleHomepageImageUpload(event, 'logo')">
            </div>

            <label style="font-weight:700; margin-top:8px;">파비콘 (브라우저 탭 아이콘) - 권장 사이즈: 512×512px</label>
            <div style="display:flex; gap:8px; align-items:center;">
              <img id="adm-home-favicon-preview" src="" alt="파비콘" style="width:64px; height:64px; object-fit:contain; border:1px solid #e2e8f0; border-radius:6px; display:none; background:#fff; padding:4px;">
              <input type="file" id="adm-home-favicon-file" accept="image/*" onchange="handleHomepageImageUpload(event, 'favicon')">
            </div>

            <div style="display:flex; gap:8px; margin-top:6px;">
              <button class="btn btn-primary" onclick="saveHomepageContent()">저장</button>
              <button class="btn" onclick="applyHomepageContent(true)" style="background:#e2e8f0; color:#475569;">미리보기 적용</button>
              <button class="btn" onclick="resetHomepageCache()" style="background:#ef4444; color:#fff; border:none;">캐시 초기화</button>
            </div>
          </div>
        </div>

        <div id="adm-popup" style="display:none;" class="card">
          <div style="padding:16px; border-bottom:1px solid var(--line); background:#f8fafc; font-weight:1000;">📢 팝업 공지사항 관리</div>
          <div style="padding:18px;">
            <div style="background:#fff; border:1px solid #e2e8f0; border-radius:8px; padding:16px; margin-bottom:20px;">
              <h3 style="margin:0 0 16px 0; font-weight:700; font-size:13px; color:#0f172a;">새 팝업 추가</h3>
              
              <div style="margin-bottom:12px;">
                <label style="display:block; font-weight:700; font-size:12px; margin-bottom:6px; color:#475569;">제목</label>
                <input type="hidden" id="popup-id">
                <input type="text" id="popup-title" placeholder="팝업 제목 입력" style="width:100%; padding:8px 10px; border:1px solid #cbd5e1; border-radius:6px; font-size:12px; box-sizing:border-box;">
              </div>

              <div style="margin-bottom:12px;">
                <label style="display:block; font-weight:700; font-size:12px; margin-bottom:6px; color:#475569;">내용</label>
                <textarea id="popup-content" placeholder="팝업 내용 입력" style="width:100%; padding:8px 10px; border:1px solid #cbd5e1; border-radius:6px; font-size:12px; min-height:100px; font-family:inherit; resize:vertical; box-sizing:border-box;"></textarea>
              </div>

              <div style="margin-bottom:12px;">
                <label style="display:block; font-weight:700; font-size:12px; margin-bottom:6px; color:#475569;">이미지 업로드</label>
                <input type="text" id="popup-image" placeholder="이미지 경로" style="width:100%; padding:8px 10px; border:1px solid #cbd5e1; border-radius:6px; font-size:12px; box-sizing:border-box; margin-bottom:8px;">
                <input type="file" id="popup-image-file" accept="image/*" style="width:100%; padding:6px; border:1px solid #cbd5e1; border-radius:6px; font-size:12px; box-sizing:border-box;">
                <div style="display:flex; gap:8px; margin-top:8px;">
                  <button class="btn" onclick="uploadPopupImage()" style="background:#e2e8f0; color:#475569; border:none;">이미지 업로드</button>
                  <button class="btn" onclick="previewPopupImage()" style="background:#e2e8f0; color:#475569; border:none;">미리보기</button>
                </div>
                <img id="popup-image-preview" src="" alt="미리보기" style="width:100%; max-width:200px; margin-top:8px; border:1px solid #e2e8f0; border-radius:6px; display:none;">
              </div>

              <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:12px;">
                <div>
                  <label style="display:block; font-weight:700; font-size:12px; margin-bottom:6px; color:#475569;">뱃지(선택)</label>
                  <input type="text" id="popup-badge" placeholder="예: 점검공지" style="width:100%; padding:8px 10px; border:1px solid #cbd5e1; border-radius:6px; font-size:12px; box-sizing:border-box;">
                </div>
                <div style="display:flex; align-items:center; gap:8px; margin-top:22px;">
                  <input type="checkbox" id="popup-active" checked>
                  <label for="popup-active" style="font-size:12px; color:#475569;">활성화</label>
                </div>
              </div>

              <div style="display:flex; gap:8px;">
                <button class="btn btn-primary" onclick="savePopupNotice()" style="flex:1; padding:10px; font-size:12px; font-weight:600;">팝업 저장</button>
                <button class="btn" onclick="resetPopupForm()" style="flex:1; padding:10px; font-size:12px; font-weight:600; background:#e2e8f0; color:#475569; border:none;">초기화</button>
                <button class="btn" onclick="deletePopupNotice()" style="flex:1; padding:10px; font-size:12px; font-weight:600; background:#ef4444; color:#fff; border:none;">팝업 삭제</button>
              </div>
            </div>

            <div style="border-top:1px solid #e2e8f0; padding-top:16px;">
              <h3 style="margin:0 0 12px 0; font-weight:700; font-size:13px; color:#0f172a;">팝업 목록</h3>
              <div id="admin-popup-list" style="display:flex; flex-direction:column; gap:8px; max-height:400px; overflow-y:auto;"></div>
            </div>
          </div>
        </div>

        <div id="adm-notice" style="display:none;" class="card">
          <div style="padding:16px; border-bottom:1px solid var(--line); background:#f8fafc; font-weight:1000;">📋 공지사항 관리</div>
          <div style="padding:18px;">
            <div style="background:#fff; border:1px solid #e2e8f0; border-radius:8px; padding:16px; margin-bottom:20px;">
              <h3 style="margin:0 0 16px 0; font-weight:700; font-size:13px; color:#0f172a;">새 공지사항 추가</h3>
              
              <div style="margin-bottom:12px;">
                <label style="display:block; font-weight:700; font-size:12px; margin-bottom:6px; color:#475569;">제목</label>
                <input type="hidden" id="notice-id">
                <input type="text" id="notice-title" placeholder="공지사항 제목 입력" style="width:100%; padding:8px 10px; border:1px solid #cbd5e1; border-radius:6px; font-size:12px; box-sizing:border-box;">
              </div>

              <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:12px;">
                <div>
                  <label style="display:block; font-weight:700; font-size:12px; margin-bottom:6px; color:#475569;">카테고리</label>
                  <select id="notice-category" style="width:100%; padding:8px 10px; border:1px solid #cbd5e1; border-radius:6px; font-size:12px; box-sizing:border-box;">
                    <option value="일반공지">일반공지</option>
                    <option value="점검공지">점검공지</option>
                    <option value="신제품공지">신제품공지</option>
                  </select>
                </div>
                <div style="display:flex; align-items:center; gap:8px; margin-top:22px;">
                  <input type="checkbox" id="notice-pinned">
                  <label for="notice-pinned" style="font-size:12px; color:#475569;">상단 고정</label>
                </div>
              </div>

              <div style="margin-bottom:12px;">
                <label style="display:block; font-weight:700; font-size:12px; margin-bottom:6px; color:#475569;">내용</label>
                <textarea id="notice-content" placeholder="공지사항 내용 입력" style="width:100%; padding:8px 10px; border:1px solid #cbd5e1; border-radius:6px; font-size:12px; min-height:100px; font-family:inherit; resize:vertical; box-sizing:border-box;"></textarea>
              </div>

              <div style="display:flex; gap:8px;">
                <button class="btn btn-primary" onclick="saveNotice()" style="flex:1; padding:10px; font-size:12px; font-weight:600;">공지사항 저장</button>
                <button class="btn" onclick="resetNoticeForm()" style="flex:1; padding:10px; font-size:12px; font-weight:600; background:#e2e8f0; color:#475569; border:none;">초기화</button>
                <button class="btn" onclick="deleteNotice()" style="flex:1; padding:10px; font-size:12px; font-weight:600; background:#ef4444; color:#fff; border:none;">공지 삭제</button>
              </div>
            </div>

            <div style="border-top:1px solid #e2e8f0; padding-top:16px;">
              <h3 style="margin:0 0 12px 0; font-weight:700; font-size:13px; color:#0f172a;">공지사항 목록</h3>
              <div id="admin-notice-list" style="display:flex; flex-direction:column; gap:8px; max-height:400px; overflow-y:auto;"></div>
            </div>
          </div>
        </div>

        <div id="adm-users" style="display:none;" class="card">
          <div style="padding:16px; border-bottom:1px solid var(--line); background:#f8fafc; font-weight:1000;">👥 회원 목록</div>
          <div style="padding:18px; overflow-x:auto;">
            <table style="width:100%; border-collapse:collapse; font-size:13px;">
              <thead>
                <tr style="background:#f8fafc; border-bottom:2px solid var(--line);">
                  <th style="padding:10px; text-align:left; font-weight:1000;">고객번호</th>
                  <th style="padding:10px; text-align:left; font-weight:1000;">아이디</th>
                  <th style="padding:10px; text-align:left; font-weight:1000;">이름</th>
                  <th style="padding:10px; text-align:left; font-weight:1000;">연락처</th>
                  <th style="padding:10px; text-align:left; font-weight:1000;">주소</th>
                  <th style="padding:10px; text-align:left; font-weight:1000;">유형</th>
                  <th style="padding:10px; text-align:left; font-weight:1000;">사업자명</th>
                  <th style="padding:10px; text-align:left; font-weight:1000;">사업자번호</th>
                  <th style="padding:10px; text-align:left; font-weight:1000;">상태</th>
                  <th style="padding:10px; text-align:left; font-weight:1000;">가입일</th>
                  <th style="padding:10px; text-align:center; font-weight:1000;">관리</th>
                </tr>
              </thead>
              <tbody id="user-list-body">
                <tr><td colspan="11" style="padding:30px; text-align:center; color:#64748b;">등록된 회원이 없습니다.</td></tr>
              </tbody>
            </table>
          </div>
        </div>

        <div id="adm-payment-links" style="display:none;" class="card">
          <div style="padding:16px; border-bottom:1px solid var(--line); background:#f8fafc; font-weight:1000; display:flex; justify-content:space-between; align-items:center;">
            <span>💳 개인결제 링크 관리</span>
            <button class="btn btn-primary" onclick="if(typeof window.showCreatePaymentLinkForm==='function') window.showCreatePaymentLinkForm(); else alert('기능 로딩 중입니다. 잠시 후 다시 시도해주세요.');" style="font-size:13px; padding:8px 16px;">+ 새 링크 생성</button>
          </div>

          <!-- 링크 생성 폼 -->
          <div id="payment-link-form" style="display:none; padding:18px; border-bottom:1px solid var(--line); background:#fafafa;">
            <h4 style="margin:0 0 16px 0; font-size:15px; font-weight:700; color:#0f172a;">새 개인결제 링크 생성</h4>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-bottom:12px;">
              <div>
                <label style="display:block; font-size:12px; font-weight:600; color:#64748b; margin-bottom:4px;">상품명 <span style="color:#ef4444;">*</span></label>
                <input type="text" id="pay-link-product" placeholder="예: 명함 1박스" style="width:100%; padding:8px; border:1px solid var(--line); border-radius:6px; font-size:13px;" />
              </div>
              <div>
                <label style="display:block; font-size:12px; font-weight:600; color:#64748b; margin-bottom:4px;">결제금액 (원) <span style="color:#ef4444;">*</span></label>
                <input type="number" id="pay-link-price" placeholder="10000" min="1000" style="width:100%; padding:8px; border:1px solid var(--line); border-radius:6px; font-size:13px;" />
              </div>
              <div style="display:none;">
                <label style="display:block; font-size:12px; font-weight:600; color:#64748b; margin-bottom:4px;">고객명 (자동수집)</label>
                <input type="text" id="pay-link-customer-name" placeholder="로그인 후 자동입력" readonly style="width:100%; padding:8px; border:1px solid var(--line); border-radius:6px; font-size:13px; background:#f0fdf4; color:#15803d;" />
              </div>
              <div style="display:none;">
                <label style="display:block; font-size:12px; font-weight:600; color:#64748b; margin-bottom:4px;">고객 연락처 (자동수집)</label>
                <input type="text" id="pay-link-customer-phone" placeholder="로그인 후 자동입력" readonly style="width:100%; padding:8px; border:1px solid var(--line); border-radius:6px; font-size:13px; background:#f0fdf4; color:#15803d;" />
              </div>
            </div>
            <div style="margin-bottom:12px;">
              <label style="display:block; font-size:12px; font-weight:600; color:#64748b; margin-bottom:4px;">메모 (선택)</label>
              <textarea id="pay-link-memo" placeholder="내부 메모..." rows="2" style="width:100%; padding:8px; border:1px solid var(--line); border-radius:6px; font-size:13px; resize:vertical;"></textarea>
            </div>

            <!-- 사양 입력 -->
            <div style="border:1px solid #e2e8f0; border-radius:8px; padding:12px; margin-bottom:12px; background:#f9fafb;">
              <h5 style="margin:0 0 12px 0; font-size:13px; font-weight:700; color:#475569;">📋 사양 (고객에게 공지될 내용)</h5>
              
              <div style="margin-bottom:12px;">
                <label style="display:block; font-size:12px; font-weight:600; color:#475569; margin-bottom:4px;">상품 유형 <span style="color:#ef4444;">*</span></label>
                <select id="pay-link-product-type" onchange="togglePayLinkSpecsFields()" style="width:100%; padding:8px; border:1px solid var(--line); border-radius:6px; font-size:13px;">
                  <option value="book">책/제본</option>
                  <option value="flyer">전단지/리플렛</option>
                </select>
              </div>

              <!-- 책/제본 필드 -->
              <div id="pay-link-book-specs" style="display:block;">
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:10px;">
                  <div>
                    <label style="display:block; font-size:12px; font-weight:600; color:#475569; margin-bottom:4px;">표지 용지 <span style="color:#ef4444;">*</span></label>
                    <input type="text" id="pay-link-cover-paper" placeholder="예: 300g 아트지" style="width:100%; padding:8px; border:1px solid var(--line); border-radius:6px; font-size:13px;" />
                  </div>
                  <div>
                    <label style="display:block; font-size:12px; font-weight:600; color:#475569; margin-bottom:4px;">내지 용지 <span style="color:#ef4444;">*</span></label>
                    <input type="text" id="pay-link-inner-paper" placeholder="예: 120g 모조지" style="width:100%; padding:8px; border:1px solid var(--line); border-radius:6px; font-size:13px;" />
                  </div>
                  <div>
                    <label style="display:block; font-size:12px; font-weight:600; color:#475569; margin-bottom:4px;">총 페이지 수 <span style="color:#ef4444;">*</span></label>
                    <input type="number" id="pay-link-total-pages" placeholder="예: 100" min="1" style="width:100%; padding:8px; border:1px solid var(--line); border-radius:6px; font-size:13px;" />
                  </div>
                  <div>
                    <label style="display:block; font-size:12px; font-weight:600; color:#475569; margin-bottom:4px;">제본 방식 <span style="color:#ef4444;">*</span></label>
                    <select id="pay-link-binding" style="width:100%; padding:8px; border:1px solid var(--line); border-radius:6px; font-size:13px;">
                      <option value="">선택해주세요</option>
                      <option value="중철">중철</option>
                      <option value="무선">무선</option>
                      <option value="펴본">펴본</option>
                    </select>
                  </div>
                  <div style="grid-column:1/-1;">
                    <label style="display:block; font-size:12px; font-weight:600; color:#475569; margin-bottom:4px;">인쇄 부수 <span style="color:#ef4444;">*</span></label>
                    <input type="number" id="pay-link-print-qty" placeholder="예: 500" min="1" style="width:100%; padding:8px; border:1px solid var(--line); border-radius:6px; font-size:13px;" />
                  </div>
                </div>
              </div>

              <!-- 전단지 필드 -->
              <div id="pay-link-flyer-specs" style="display:none;">
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:10px;">
                  <div>
                    <label style="display:block; font-size:12px; font-weight:600; color:#475569; margin-bottom:4px;">단장 용지 <span style="color:#ef4444;">*</span></label>
                    <input type="text" id="pay-link-single-paper" placeholder="예: 200g 코팅지" style="width:100%; padding:8px; border:1px solid var(--line); border-radius:6px; font-size:13px;" />
                  </div>
                  <div>
                    <label style="display:block; font-size:12px; font-weight:600; color:#475569; margin-bottom:4px;">인쇄 부수 <span style="color:#ef4444;">*</span></label>
                    <input type="number" id="pay-link-flyer-qty" placeholder="예: 1000" min="1" style="width:100%; padding:8px; border:1px solid var(--line); border-radius:6px; font-size:13px;" />
                  </div>
                  <div style="grid-column:1/-1;">
                    <label style="display:block; font-size:12px; font-weight:600; color:#475569; margin-bottom:4px;">후가공 <span style="color:#ef4444;">*</span></label>
                    <input type="text" id="pay-link-flyer-finishing" placeholder="예: 폴딩(3등분), 라미네이션, 천공" style="width:100%; padding:8px; border:1px solid var(--line); border-radius:6px; font-size:13px;" />
                  </div>
                </div>
              </div>

              <!-- 공통 특이사항 -->
              <div>
                <label style="display:block; font-size:12px; font-weight:600; color:#475569; margin-bottom:4px;">특이사항</label>
                <textarea id="pay-link-special-note" placeholder="예: 무광 코팅, 양면 컬러" rows="2" style="width:100%; padding:8px; border:1px solid var(--line); border-radius:6px; font-size:13px; resize:vertical;"></textarea>
              </div>
            </div>

            <div style="display:flex; gap:8px;">
              <button class="btn btn-primary" onclick="createPaymentLink()" style="flex:1;">링크 생성</button>
              <button class="btn btn-secondary" onclick="hideCreatePaymentLinkForm()" style="flex:1;">취소</button>
            </div>
          </div>

          <!-- 링크 목록 -->
          <div style="padding:18px; overflow-x:auto;">
            <table style="width:100%; border-collapse:collapse; font-size:13px;">
              <thead>
                <tr style="background:#f8fafc; border-bottom:2px solid var(--line);">
                  <th style="padding:10px; text-align:left; font-weight:1000;">링크코드</th>
                  <th style="padding:10px; text-align:left; font-weight:1000;">상품명</th>
                  <th style="padding:10px; text-align:right; font-weight:1000;">금액</th>
                  <th style="padding:10px; text-align:left; font-weight:1000;">고객명</th>
                  <th style="padding:10px; text-align:left; font-weight:1000;">연락처</th>
                  <th style="padding:10px; text-align:center; font-weight:1000;">상태</th>
                  <th style="padding:10px; text-align:left; font-weight:1000;">생성일</th>
                  <th style="padding:10px; text-align:center; font-weight:1000;">관리</th>
                </tr>
              </thead>
              <tbody id="payment-link-list-body">
                <tr><td colspan="8" style="padding:30px; text-align:center; color:#64748b;">생성된 링크가 없습니다.</td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <footer style="background:#f5f5f5; border-top:1px solid #e0e0e0; padding:40px 0; margin-top:32px;">
      <div style="max-width:1200px; margin:0 auto; padding:0 20px;">
        <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(280px, 1fr)); gap:32px; margin-bottom:36px;">
          
          <!-- 고객센터 -->
          <div>
            <h3 style="margin:0 0 4px 0; font-size:13px; font-weight:600; color:#999; letter-spacing:0.5px;">CUSTOMER CENTER</h3>
            <p style="margin:0 0 12px 0; font-size:32px; font-weight:900; color:#d91e82; line-height:1.2;">062-225-1723</p>
            <div style="font-size:13px; line-height:1.8; color:#666;">
              <p style="margin:0 0 4px 0;"><strong style="color:#333;">상담시간 :</strong> 월~금 09:00 - 18:00</p>
              <p style="margin:0 0 4px 0;"><strong style="color:#333;">접수시간 :</strong> 월~금 09:00 - 18:00</p>
              <p style="margin:0; color:#d91e82; font-weight:600;">토·일·공휴일: 휴무</p>
            </div>
          </div>

          <!-- 계좌정보 -->
          <div>
            <h3 style="margin:0 0 12px 0; font-size:13px; font-weight:600; color:#999; letter-spacing:0.5px;">BANK INFO</h3>
            <div style="display:flex; align-items:center; gap:12px; margin-bottom:12px;">
              <div style="background:#008485; color:#fff; font-weight:900; font-size:16px; padding:6px 12px; border-radius:6px;">NH</div>
              <span style="font-size:16px; font-weight:700; color:#333;">농협</span>
              <div style="display:flex; align-items:center; gap:6px;">
                <span style="font-size:18px; font-weight:700; color:#333; letter-spacing:0.5px;">301-0101-0038-81</span>
                <button onclick="navigator.clipboard.writeText('301-0101-0038-81'); toast('계좌번호가 복사되었습니다');" style="background:#008485; color:#fff; border:none; border-radius:4px; padding:4px 8px; font-size:11px; font-weight:600; cursor:pointer;">복사</button>
              </div>
            </div>
            <p style="margin:0; font-size:16px; font-weight:700; color:#333;">예금주 : (주)건우프린팅</p>
          </div>

          <!-- 웹하드 -->
          <div>
            <h3 style="margin:0 0 12px 0; font-size:13px; font-weight:600; color:#999; letter-spacing:0.5px;">WEBHARD</h3>
            <div style="background:#fffbeb; border:2px solid #fbbf24; border-radius:8px; padding:6px 10px; margin-bottom:12px; text-align:center; display:inline-block;">
              <p style="margin:0; font-size:12px; line-height:1.4; color:#92400e; font-weight:600; white-space:nowrap;">
                게스트 선택 후 <span style="color:#dc2626; font-weight:bold;">아이디</span> <span style="color:#dc2626; font-weight:bold;">비밀번호</span> 입력해서 사용하면 됩니다.
              </p>
            </div>
            <div style="display:flex; align-items:center; gap:12px; margin-bottom:12px; flex-wrap:wrap;">
              <div style="font-size:13px; line-height:1.8; color:#666;">
                <p style="margin:0 0 4px 0;"><strong style="color:#333;">ID :</strong> <span style="font-size:16px; font-weight:700; color:#037a3f;">gunusa</span></p>
                <p style="margin:0;"><strong style="color:#333;">PW :</strong> <span style="font-size:16px; font-weight:700; color:#037a3f;">2251723</span></p>
              </div>
              <a href="https://only.webhard.co.kr/login?id=gunusa" target="_blank" style="display:inline-block; background:#037a3f; color:#fff; padding:8px 16px; border-radius:6px; text-decoration:none; font-weight:700; font-size:12px;">웹하드 바로가기 →</a>
            </div>

            <div style="display:flex; align-items:center; gap:10px; font-size:13px; color:#999;">
              <h3 style="margin:0; font-size:13px; font-weight:600; color:#999; letter-spacing:0.5px;">E-MAIL</h3>
              <span style="font-size:12px; color:#9ca3af;">ms4012@daum.net</span>
            </div>
          </div>
        </div>

        <div style="padding-bottom:24px; border-bottom:1px solid #e6edf3; margin-bottom:24px; font-size:13px; color:#475569;">
          <a href="#" onclick="toast('회사소개'); return false;" style="color:#475569; text-decoration:none; margin-right:20px;">회사소개</a>
          <a href="#" onclick="toast('이용약관'); return false;" style="color:#475569; text-decoration:none; margin-right:20px;">이용약관</a>
          <a href="#" onclick="toast('개인정보처리방침'); return false;" style="color:#475569; text-decoration:none; margin-right:20px;">개인정보처리방침</a>
          <a href="#" onclick="toast('이용문의'); return false;" style="color:#475569; text-decoration:none;">이용문의</a>
        </div>

        <div style="font-size:11px; color:#64748b; line-height:1.8;">
          <p style="margin:0 0 10px 0;"><strong style="color:#475569; font-weight:700;">회사정보</strong></p>
          <p style="margin:0;">회사명 : (주)건우프린팅　대표자 : 김주희　사업자번호 : </p>
          <p style="margin:4px 0;">통신판매신고번호 : 　본사 : 광주광역시 동구 백서로 137번길 13-6</p>
          <p style="margin:4px 0;">소재지(접수/출고) : 광주광역시 동구 백서로 137번길 13-6</p>
          
          <p style="margin:16px 0 0 0; padding-top:16px; border-top:1px solid #e6edf3; display:flex; justify-content:space-between; align-items:center;">
            <span>Copyright © 2024 GUNWO PRINTING. All Rights Reserved.</span>
            <a id="footer-admin-link" href="#" onclick="goAdmin(); return false;" style="color:#64748b; text-decoration:none; font-weight:600; font-size:12px; display:none;">관리자페이지</a>
          </p>
        </div>

      </div>
    </footer>

    <!-- Kakao 상담 플로팅 버튼 -->
     <a href="https://pf.kakao.com/_YOUR_KAKAO_LINK_" target="_blank" aria-label="카카오 상담" 
       style="position:fixed; right:18px; bottom:18px; z-index:9999; text-decoration:none;">
      <div style="background:#fee500; color:#191600; border-radius:999px; padding:14px 18px; box-shadow:0 10px 25px -12px rgba(0,0,0,0.24); display:flex; align-items:center; gap:8px; font-weight:800; font-size:13px;">
        <span style="display:inline-block; width:18px; height:18px; background:#191600; color:#fee500; border-radius:4px; text-align:center; line-height:18px; font-size:12px;">K</span>
        <span>카카오 상담</span>
      </div>
    </a>

    </footer>

  </div>

  <div class="full-menu-overlay" id="full-menu-overlay" onclick="toggleFullMenu()"></div>

  <div class="toast" id="toast"></div>

  <!-- 팝업 공지 기본 템플릿 (스크립트에서 클론하여 사용) -->
  <div id="popup-notice-window" style="display:none; position:fixed; right:30px; top:30px; z-index:3000; background:#fff; border:1px solid var(--line); box-shadow:0 10px 30px rgba(0,0,0,0.25); border-radius:0; overflow:hidden; min-width:300px;">
    <div id="popup-notice-header" style="display:flex; justify-content:space-between; align-items:center; padding:0px 4px; border-bottom:1px solid var(--line); background:#f8fafc; cursor:move; min-height:20px;">
      <div style="display:flex; align-items:center; gap:6px;">
        <span id="popup-modal-title" style="font-weight:900; font-size:14px; color:#0f172a; display:none;">제목</span>
      </div>
      <button class="popup-close-btn" style="background:none; border:none; font-size:12px; color:#94a3b8; cursor:pointer; line-height:1; padding:2px 4px;">✕</button>
    </div>
    <div style="padding:14px;">
      <img id="popup-modal-image" src="" alt="팝업 이미지" style="width:100%; border-radius:0; border:1px solid #e2e8f0; margin-bottom:10px; display:block;">
      <div id="popup-modal-content" style="color:#334155; font-size:13px; line-height:1.6;">내용</div>
      <div style="display:flex; align-items:center; justify-content:space-between; gap:12px; margin-top:12px;">
        <label style="display:flex; align-items:center; gap:8px; font-size:12px; color:#64748b; margin:0;">
          <input type="checkbox" id="popup-hide-today-check" style="cursor:pointer;">
          오늘 더 이상 보지 않기
        </label>
        <div>
          <button class="popup-close-btn" style="padding:4px 8px; font-size:11px; background:#e2e8f0; color:#475569; border:none; border-radius:8px; font-weight:600; cursor:pointer; min-width:56px;">닫기</button>
        </div>
      </div>
    </div>
  </div>

  <script src="slide_popup_functions.js?v=20260124g"></script>
  <script src="payment_link_functions.js?v=20260124p"></script>
  <script src="script.js?v=20260124r"></script>
  
  <!-- ==================== 개인결제 링크 관리 ====================  -->
  <script>
// ==================== 개인결제 링크 관리 ====================

async function loadPaymentLinks() {
  try {
    const token = getToken();
    const res = await fetch('/api/payment-links', {
      headers: { 'Authorization': `Bearer ${token}` }
    });
    const data = await res.json();
    
    if (!data.success) {
      console.error('링크 목록 로드 실패:', data.message);
      return;
    }

    const tbody = get('payment-link-list-body');
    if (!tbody) return;

    if (!data.links || data.links.length === 0) {
      tbody.innerHTML = '<tr><td colspan="8" style="padding:30px; text-align:center; color:#64748b;">생성된 링크가 없습니다.</td></tr>';
      return;
    }

    tbody.innerHTML = data.links.map(link => {
      const linkUrl = `${window.location.origin}/?pay=${link.link_code}`;
      const statusBadge = link.is_used
        ? '<span style="background:#10b981; color:#fff; padding:3px 8px; border-radius:999px; font-size:11px; font-weight:700;">✓ 사용완료</span>'
        : '<span style="background:#f59e0b; color:#fff; padding:3px 8px; border-radius:999px; font-size:11px; font-weight:700;">⏳ 미사용</span>';

      return `
        <tr style="border-bottom:1px solid var(--line);">
          <td style="padding:10px; font-family:monospace; font-weight:700; color:#037a3f;">${link.link_code}</td>
          <td style="padding:10px;">${link.product_name}</td>
          <td style="padding:10px; text-align:right; font-weight:700; color:#0f172a;">${(link.price || 0).toLocaleString()}원</td>
          <td style="padding:10px;">${link.customer_name || '-'}</td>
          <td style="padding:10px;">${link.customer_phone || '-'}</td>
          <td style="padding:10px; text-align:center;">${statusBadge}</td>
          <td style="padding:10px; font-size:11px; color:#64748b;">${formatDate(link.created_at)}</td>
          <td style="padding:10px; text-align:center;">
            <button class="btn" style="background:#3b82f6; color:#fff; padding:4px 8px; font-size:11px; border:none; border-radius:4px; cursor:pointer; margin-right:4px;" onclick="copyPaymentLink('${linkUrl}')">복사</button>
            ${!link.is_used ? `<button class="btn" style="background:#ef4444; color:#fff; padding:4px 8px; font-size:11px; border:none; border-radius:4px; cursor:pointer;" onclick="deletePaymentLink(${link.id})">삭제</button>` : ''}
          </td>
        </tr>
      `;
    }).join('');

  } catch (error) {
    console.error('링크 목록 로드 오류:', error);
  }
}

function showCreatePaymentLinkForm() {
  const form = get('payment-link-form');
  if (form) form.style.display = 'block';
  
  // 입력 폼 초기화
  if (get('pay-link-product')) get('pay-link-product').value = '';
  if (get('pay-link-price')) get('pay-link-price').value = '';
  if (get('pay-link-customer-name')) get('pay-link-customer-name').value = '';
  if (get('pay-link-customer-phone')) get('pay-link-customer-phone').value = '';
  if (get('pay-link-memo')) get('pay-link-memo').value = '';
  if (get('pay-link-product-type')) get('pay-link-product-type').value = 'book';
  if (get('pay-link-cover-paper')) get('pay-link-cover-paper').value = '';
  if (get('pay-link-inner-paper')) get('pay-link-inner-paper').value = '';
  if (get('pay-link-total-pages')) get('pay-link-total-pages').value = '';
  if (get('pay-link-binding')) get('pay-link-binding').value = '';
  if (get('pay-link-print-qty')) get('pay-link-print-qty').value = '';
  if (get('pay-link-single-paper')) get('pay-link-single-paper').value = '';
  if (get('pay-link-flyer-qty')) get('pay-link-flyer-qty').value = '';
  if (get('pay-link-flyer-finishing')) get('pay-link-flyer-finishing').value = '';
  if (get('pay-link-special-note')) get('pay-link-special-note').value = '';
  
  togglePayLinkSpecsFields();
}

function togglePayLinkSpecsFields() {
  const type = get('pay-link-product-type')?.value || 'book';
  const bookSection = get('pay-link-book-specs');
  const flyerSection = get('pay-link-flyer-specs');
  
  if (bookSection) bookSection.style.display = type === 'book' ? 'block' : 'none';
  if (flyerSection) flyerSection.style.display = type === 'flyer' ? 'block' : 'none';
}

function hideCreatePaymentLinkForm() {
  const form = get('payment-link-form');
  if (form) form.style.display = 'none';
}

async function createPaymentLink() {
  const product_name = get('pay-link-product')?.value?.trim();
  const price = parseFloat(get('pay-link-price')?.value || 0);
  const customer_name = get('pay-link-customer-name')?.value?.trim();
  const customer_phone = get('pay-link-customer-phone')?.value?.trim();
  const memo = get('pay-link-memo')?.value?.trim();
  const productType = get('pay-link-product-type')?.value || 'book';
  const specialNote = get('pay-link-special-note')?.value?.trim();

  if (!product_name) {
    alert('상품명을 입력해주세요.');
    return;
  }

  if (!price || price < 1000) {
    alert('결제금액은 1,000원 이상이어야 합니다.');
    return;
  }

  let specs = null;

  if (productType === 'book') {
    const coverPaper = get('pay-link-cover-paper')?.value?.trim();
    const innerPaper = get('pay-link-inner-paper')?.value?.trim();
    const totalPages = get('pay-link-total-pages')?.value?.trim();
    const binding = get('pay-link-binding')?.value;
    const printQty = get('pay-link-print-qty')?.value?.trim();

    if (!coverPaper || !innerPaper || !totalPages || !binding || !printQty) {
      alert('책 사양을 모두 입력해주세요.');
      return;
    }

    specs = {
      type: 'book',
      coverPaper,
      innerPaper,
      totalPages,
      binding,
      printQuantity: printQty,
      specialNote
    };
  } else if (productType === 'flyer') {
    const singlePaper = get('pay-link-single-paper')?.value?.trim();
    const flyerQty = get('pay-link-flyer-qty')?.value?.trim();
    const finishing = get('pay-link-flyer-finishing')?.value?.trim();

    if (!singlePaper || !flyerQty || !finishing) {
      alert('전단지 사양을 모두 입력해주세요.');
      return;
    }

    specs = {
      type: 'flyer',
      singlePaper,
      printQuantity: flyerQty,
      finishing,
      specialNote
    };
  }

  const memoPayload = JSON.stringify({ specs, note: memo || '' });

  try {
    const token = getToken();
    const res = await fetch('/api/payment-links', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${token}`
      },
      body: JSON.stringify({
        product_name,
        price,
        customer_name,
        customer_phone,
        memo: memoPayload
      })
    });

    const data = await res.json();
    
    if (!data.success) {
      alert(data.message || '링크 생성에 실패했습니다.');
      return;
    }

    toast('개인결제 링크가 생성되었습니다.');
    hideCreatePaymentLinkForm();
    loadPaymentLinks();

    // 생성된 링크 자동 복사
    const linkUrl = `${window.location.origin}/?pay=${data.link.link_code}`;
    copyPaymentLink(linkUrl);

  } catch (error) {
    console.error('링크 생성 오류:', error);
    alert('링크 생성 중 오류가 발생했습니다.');
  }
}

function copyPaymentLink(url) {
  navigator.clipboard.writeText(url).then(() => {
    toast('결제 링크가 복사되었습니다!');
  }).catch(err => {
    console.error('복사 실패:', err);
    alert('링크 복사에 실패했습니다: ' + url);
  });
}

async function deletePaymentLink(linkId) {
  if (!confirm('이 링크를 삭제하시겠습니까?')) return;

  try {
    const token = getToken();
    const res = await fetch(`/api/payment-links/${linkId}`, {
      method: 'DELETE',
      headers: { 'Authorization': `Bearer ${token}` }
    });

    const data = await res.json();
    
    if (!data.success) {
      alert(data.message || '링크 삭제에 실패했습니다.');
      return;
    }

    toast('링크가 삭제되었습니다.');
    loadPaymentLinks();

  } catch (error) {
    console.error('링크 삭제 오류:', error);
    alert('링크 삭제 중 오류가 발생했습니다.');
  }
}

// 개인결제 링크로 접속 시 처리
async function checkPaymentLinkAccess(skipTokenCheck = false) {
  // Context already active - prevent duplicate calls
  if (window.paymentLinkContext && window.paymentLinkContext.isActive && window.paymentLinkContext.isChecked) {
    console.log('[checkPaymentLinkAccess] Context already set - preventing duplicate');
    return;
  }

  const params = new URLSearchParams(window.location.search);
  const payCode = params.get('pay');
  
  console.log('[checkPaymentLinkAccess] Starting');
  console.log('[checkPaymentLinkAccess] Current URL:', window.location.href);
  console.log('[checkPaymentLinkAccess] URL params:', params.toString());
  console.log('[checkPaymentLinkAccess] payCode:', payCode);

  if (!payCode) {
    console.log('[checkPaymentLinkAccess] No payCode - early exit');
    return;
  }

  // Initialize context
  if (window.paymentLinkContext) {
    window.paymentLinkContext.start(payCode);
  }

  // Check login status (localStorage-based)
  if (!skipTokenCheck) {
    const token = getToken();
    const userData = localStorage.getItem('print_current_user');
    
    if (token && !userData) {
      console.log('[checkPaymentLinkAccess] Token exists but no user info - removing token');
      if (typeof removeToken === 'function') removeToken();
    }
  }

  try {
    console.log('[checkPaymentLinkAccess] API call:', `/api/payment-links/${payCode}`);
    const res = await fetch(`/api/payment-links/${payCode}`);
    console.log('[checkPaymentLinkAccess] API response status:', res.status, res.statusText);
    
    const data = await res.json();
    console.log('[checkPaymentLinkAccess] API data:', data.success ? 'success' : 'failed');

    if (!data.success) {
      console.error('[checkPaymentLinkAccess] API failed:', data.message);
      alert(data.message || 'Invalid payment link.');
      if (window.paymentLinkContext) window.paymentLinkContext.complete();
      window.location.href = '/';
      return;
    }

    const link = data.link;
    console.log('[checkPaymentLinkAccess] Link info received:', link);
    
    // Save link to context
    if (window.paymentLinkContext) {
      window.paymentLinkContext.setLink(link);
    }
    
    // Display payment screen
    showPaymentLinkPage(link);

  } catch (error) {
    console.error('[checkPaymentLinkAccess] Error:', error);
    alert('An error occurred while checking the payment link.');
    if (window.paymentLinkContext) window.paymentLinkContext.complete();
    window.location.href = '/';
  }
}

// 홈 단축메뉴에서 개인결제창 클릭 시
function goPersonalPayment() {
  alert('개인결제 링크는 관리자가 생성한 링크로만 접속 가능합니다.\n\n관리자 패널 → 💳 개인결제 링크 메뉴에서 링크를 생성하세요.');
}

function showPaymentLinkPage(link) {
  console.log('[showPaymentLinkPage] Called, link info:', link);
  
  // Context check - verify payment link context is active
  if (window.paymentLinkContext && window.paymentLinkContext.isActive) {
    console.log('[showPaymentLinkPage] Context active:', window.paymentLinkContext.code);
  } else {
    console.warn('[showPaymentLinkPage] Context not active');
  }
  
  // Save payment link code to sessionStorage
  // (allows goLogin() to access value even if URL changes)
  // Field name: link.link_code (not link.code!)
  if (link && link.link_code) {
    sessionStorage.setItem('_pendingPaymentLink', link.link_code);
    console.log('[showPaymentLinkPage] Payment code saved to sessionStorage:', link.link_code);
  } else {
    console.log('[showPaymentLinkPage] No link.link_code found:', { has_link_code: !!link?.link_code, link_keys: link ? Object.keys(link) : 'no link' });
  }
  
  console.log('[showPaymentLinkPage] hideAll function exists:', typeof hideAll !== 'undefined' ? 'yes' : 'no');
  
  // Execute hideAll
  if (typeof hideAll === 'function') {
    console.log('[showPaymentLinkPage] Running hideAll...');
    hideAll();
    console.log('[showPaymentLinkPage] hideAll done');
  } else {
    console.error('[showPaymentLinkPage] hideAll function not found!');
  }
  
  // Check login
  const token = getToken();
  console.log('[showPaymentLinkPage] Token:', token ? 'exists' : 'missing');
  console.log('[showPaymentLinkPage] getToken function:', typeof getToken !== 'undefined' ? 'exists' : 'missing');
  
  if (!token) {
    // Display login required message
    console.log('[showPaymentLinkPage] Rendering login required screen');
    const html = `
      <div style="max-width:100%; margin:30px 0 0 0; padding:0;">
        <div class="card" style="max-width:800px; margin:0 auto; border:none; box-shadow:none; background:transparent;">
          <div style="padding:30px 20px; border-bottom:2px solid var(--line); background:transparent;">
            <h2 style="margin:0; font-size:28px; font-weight:900; color:#0f172a;">Payment</h2>
            <p style="margin:8px 0 0 0; font-size:14px; color:#64748b;">Secure payment processing</p>
          </div>
          <div style="padding:40px 20px;">
            <div style="background:linear-gradient(135deg, #fef3c7 0%, #fef08a 100%); border:2px solid #fcd34d; border-radius:12px; padding:30px; margin-bottom:30px;">
              <h3 style="margin:0 0 16px 0; font-size:18px; font-weight:700; color:#92400e;">Login Required</h3>
              <p style="margin:0 0 20px 0; font-size:14px; color:#78350f; line-height:1.6;">This is a member-only payment link.<br/>Please login first for secure payment.</p>
              <button class="btn btn-primary" onclick="goLogin()" style="width:100%; padding:14px; font-size:15px; font-weight:700;">Login</button>
              <button class="btn btn-secondary" onclick="goHome()" style="width:100%; padding:14px; font-size:14px; margin-top:12px; background:#e2e8f0; color:#475569; border:1px solid #cbd5e1;">Back to Home</button>
            </div>
          </div>
        </div>
      </div>
    `;
    
    let mainContent = document.querySelector('.main-content');
    console.log('[showPaymentLinkPage] mainContent found:', mainContent ? 'yes' : 'no');
    
    if (!mainContent) {
      console.log('[showPaymentLinkPage] Creating mainContent...');
      mainContent = document.createElement('div');
      mainContent.className = 'main-content';
      mainContent.style.maxWidth = '100%';
      mainContent.style.margin = '0';
      mainContent.style.padding = '0';
      document.body.appendChild(mainContent);
      console.log('[showPaymentLinkPage] mainContent created and added');
    }
    mainContent.innerHTML = html;
    mainContent.style.display = 'block';
    mainContent.style.visibility = 'visible';
    mainContent.style.zIndex = '1000';
    console.log('[showPaymentLinkPage] HTML rendered and displayed', {
      display: mainContent.style.display,
      visibility: mainContent.style.visibility,
      offsetHeight: mainContent.offsetHeight
    });
    window.scrollTo({ top: 0, behavior: 'smooth' });
    return;
  }
  
  // Parse memo for specs
  console.log('[showPaymentLinkPage] Preparing payment info screen...');
  let specs = null;
  let noteText = '';
  try {
    if (link.memo) {
      const parsed = JSON.parse(link.memo);
      specs = parsed.specs;
      noteText = parsed.note || '';
      console.log('[showPaymentLinkPage 로그인됨] memo 파싱 성공:', specs);
    }
  } catch (e) {
    // memo가 JSON이 아니면 그냥 텍스트로 취급
    console.error('[showPaymentLinkPage 로그인됨] memo 파싱 실패:', e);
    noteText = link.memo || '';
  }

  // 사양이 있으면 읽기 전용으로 표시
  let specsHtml = '';
  if (specs) {
    if (specs.type === 'book') {
      specsHtml = `
        <div style="background:#f9fafb; border:1px solid #e2e8f0; border-radius:8px; padding:20px; margin-bottom:20px;">
          <h3 style="margin:0 0 12px 0; font-size:14px; font-weight:700; color:#0f172a;">📖 책 사양</h3>
          <ul style="margin:0; padding-left:16px; color:#334155; font-size:13px; line-height:1.8;">
            <li>표지 용지: ${specs.coverPaper || '-'}</li>
            <li>내지 용지: ${specs.innerPaper || '-'}</li>
            <li>총 페이지: ${specs.totalPages || '-'}p</li>
            <li>제본 방식: ${specs.binding || '-'}</li>
            <li>인쇄 부수: ${specs.printQuantity || '-'}부</li>
            ${specs.specialNote ? `<li>특이사항: ${specs.specialNote}</li>` : ''}
            ${noteText ? `<li>관리자 메모: ${noteText}</li>` : ''}
          </ul>
        </div>
      `;
    } else if (specs.type === 'flyer') {
      specsHtml = `
        <div style="background:#f9fafb; border:1px solid #e2e8f0; border-radius:8px; padding:20px; margin-bottom:20px;">
          <h3 style="margin:0 0 12px 0; font-size:14px; font-weight:700; color:#0f172a;">📄 전단지 사양</h3>
          <ul style="margin:0; padding-left:16px; color:#334155; font-size:13px; line-height:1.8;">
            <li>용지: ${specs.singlePaper || '-'}</li>
            <li>인쇄 부수: ${specs.printQuantity || '-'}부</li>
            <li>후가공: ${specs.finishing || '-'}</li>
            ${specs.specialNote ? `<li>특이사항: ${specs.specialNote}</li>` : ''}
            ${noteText ? `<li>관리자 메모: ${noteText}</li>` : ''}
          </ul>
        </div>
      `;
    }
  }
  
  const html = `
    <div style="max-width:100%; margin:30px 0 0 0; padding:0;">
      <div class="card" style="max-width:900px; margin:0 auto; border:none; box-shadow:none; background:transparent;">
        <div style="padding:30px 20px; border-bottom:2px solid var(--line); background:transparent;">
          <h2 style="margin:0; font-size:28px; font-weight:900; color:#0f172a;">💳 개인결제</h2>
          <p style="margin:8px 0 0 0; font-size:14px; color:#64748b;">안전한 결제를 진행합니다</p>
        </div>
        <div style="padding:40px 20px;">
          <div style="display:grid; grid-template-columns:1fr 1fr; gap:30px; margin-bottom:30px;">
            <div style="background:linear-gradient(135deg, #f0fdf4 0%, #dbeafe 100%); border:2px solid #10b981; border-radius:12px; padding:25px;">
              <h3 style="margin:0 0 20px 0; font-size:16px; font-weight:700; color:#0f172a;">🛒 결제 정보</h3>
              <div style="display:grid; gap:16px;">
                <div>
                  <p style="margin:0 0 6px 0; font-size:12px; color:#64748b; font-weight:600; text-transform:uppercase;">상품명</p>
                  <p style="margin:0; font-size:16px; font-weight:700; color:#0f172a;">${link.product_name}</p>
                </div>
                <div>
                  <p style="margin:0 0 6px 0; font-size:12px; color:#64748b; font-weight:600; text-transform:uppercase;">결제금액</p>
                  <p style="margin:0; font-size:26px; font-weight:900; color:#10b981;">${(link.price || 0).toLocaleString()}원</p>
                </div>
                ${link.customer_name ? `
                <div>
                  <p style="margin:0 0 6px 0; font-size:12px; color:#64748b; font-weight:600; text-transform:uppercase;">고객명</p>
                  <p style="margin:0; font-size:14px; font-weight:600; color:#0f172a;">${link.customer_name}</p>
                </div>
                ` : ''}
              </div>
            </div>

            ${specsHtml ? `
            <div>
              ${specsHtml}
            </div>
            ` : ''}
          </div>

          <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
            <button class="btn btn-primary" onclick="processPaymentLink('${link.link_code}')" style="padding:16px; font-size:16px; font-weight:700; border-radius:8px;">결제하기</button>
            <button class="btn btn-secondary" onclick="goHome()" style="padding:16px; font-size:15px; background:#e2e8f0; color:#475569; border:1px solid #cbd5e1; border-radius:8px;">취소</button>
          </div>
        </div>
      </div>
    </div>
  `;

  let mainContent = document.querySelector('.main-content');
  console.log('[showPaymentLinkPage 결제정보] mainContent 찾음:', mainContent ? '있음' : '없음');
  
  if (!mainContent) {
    console.log('[showPaymentLinkPage 결제정보] mainContent 생성 중...');
    mainContent = document.createElement('div');
    mainContent.className = 'main-content';
    mainContent.style.maxWidth = '100%';
    mainContent.style.margin = '0';
    mainContent.style.padding = '0';
    document.body.appendChild(mainContent);
    console.log('[showPaymentLinkPage 결제정보] mainContent 생성 및 추가 완료');
  }
  mainContent.innerHTML = html;
  mainContent.style.display = 'block';
  mainContent.style.visibility = 'visible';
  mainContent.style.zIndex = '1000';
  console.log('[showPaymentLinkPage 결제정보] HTML 렌더링 및 표시 완료', {
    display: mainContent.style.display,
    visibility: mainContent.style.visibility,
    offsetHeight: mainContent.offsetHeight
  });
  window.scrollTo({ top: 0, behavior: 'smooth' });
  console.log('[showPaymentLinkPage 결제정보] PayApp 라이브러리 확인:', typeof PayApp !== 'undefined' ? '있음' : '없음');
}

async function processPaymentLink(linkCode) {
  console.log('[processPaymentLink] 시작:', { linkCode });
  const token = getToken();
  
  // 로그인 재확인
  if (!token) {
    console.error('[processPaymentLink] 토큰 없음 - 로그인 필요');
    alert('로그인이 필요합니다.');
    goLogin();
    return;
  }

  try {
    console.log('[processPaymentLink] 토큰 확인됨, 링크 정보 재조회 중...');
    const res = await fetch(`/api/payment-links/${linkCode}`);
    const data = await res.json();

    if (!data.success) {
      alert(data.message || '결제 링크가 만료되었거나 유효하지 않습니다.');
      goHome();
      return;
    }

    const link = data.link;

    // memo 사양 파싱 (주문 정보 기록용)
    let memoParsed = null;
    try {
      if (link.memo) memoParsed = JSON.parse(link.memo);
    } catch (e) {
      console.error('메모 파싱 실패 (무시):', e);
    }

    // 로그인한 사용자 정보 가져오기
    let userData = null;
    try {
      const userRes = await fetch('/api/user/profile', {
        headers: { 'Authorization': `Bearer ${token}` }
      });
      const userData_raw = await userRes.json();
      if (userData_raw.success) {
        userData = userData_raw.user;
      }
    } catch (e) {
      console.error('사용자 정보 조회 실패:', e);
    }

    // 주문 생성 (서버에 먼저 생성하여 PayApp 콜백에서 mul_no 저장 가능하게 함)
    const preOrderPayload = {
      items: [{
        id: 'PAYMENT_LINK',
        category: '개인결제',
        title: link.product_name,
        qty: 1,
        price: link.price
      }],
      total_price: link.price,
      delivery_info: {
        name: userData?.name || link.customer_name || '고객',
        phone: userData?.phone || '',
        addr: '',
        addr_detail: ''
      },
      order_details: {
        payment_link_code: linkCode,
        payment_link_specs: memoParsed?.specs || null,
        payment_link_note: memoParsed?.note || '',
        payment_link_raw_memo: link.memo || ''
      },
      payment_info: {
        mul_no: null,
        pay_type: 'payapp'
      }
    };
    let createdOrderId = null;
    try {
      const createRes = await fetch('/api/orders', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${token}`
        },
        body: JSON.stringify(preOrderPayload)
      });
      const createData = await createRes.json();
      if (!createData.success) {
        alert(createData.message || '주문 생성에 실패했습니다.');
        return;
      }
      createdOrderId = createData.order_id;
    } catch (e) {
      console.error('주문 생성 오류:', e);
      alert('주문 생성 중 오류가 발생했습니다.');
      return;
    }

    // PayApp 결제 시작
    console.log('[processPaymentLink] PayApp 설정 및 결제 시작');
    
    // PayApp 사용 가능 여부 확인
    if (typeof PayApp === 'undefined') {
      console.error('[processPaymentLink] PayApp 라이브러리를 찾을 수 없음!');
      alert('결제 라이브러리 로딩 실패. 페이지를 새로고침하고 다시 시도해주세요.');
      return;
    }
    
    const PAYAPP_USERID = 'vinso112';
    const PAYAPP_LINKKEY = 'RQ0pApYSGpBaGQD4VDh2ZO1DPJnCCRVaOgT+oqg6zaM=';
    const PAYAPP_LINKVALUE = 'RQ0pApYSGpBaGQD4VDh2ZKAxb4U840FF2orYsZflIx8=';

    console.log('[processPaymentLink] PayApp.setDefault 호출 중...');
    PayApp.setDefault('userid', PAYAPP_USERID);
    PayApp.setDefault('linkkey', PAYAPP_LINKKEY);
    PayApp.setDefault('linkvalue', PAYAPP_LINKVALUE);
    PayApp.setDefault('shopname', '건우프린팅');
    console.log('[processPaymentLink] PayApp.setDefault 완료');

    // 결제 링크는 returnurl을 홈으로 설정 (실제 완료는 feedback에서 처리)
    const returnUrl = window.location.origin + '/';

    console.log('[processPaymentLink] PayApp.setParam 호출 중...');
    PayApp.setParam({
      'goodname': link.product_name,
      'price': link.price.toString(),
      'recvphone': userData?.phone || '',
      'memo': `고객: ${userData?.name || link.customer_name || '고객'}`,
      'smsuse': 'n',
      'redirectpay': '1',
      'returnurl': returnUrl,
      'feedbackurl': window.location.origin + '/api/payment-callback',
      'var1': createdOrderId,
      'var2': userData?.id || linkCode,
      'skip_cstpage': 'y'
    });
    console.log('[processPaymentLink] PayApp.setParam 완료');

    // 임시 주문 저장 (결제 완료 후 복원용)
    localStorage.setItem('tempPaymentLinkOrder', JSON.stringify({
      order_id: createdOrderId,
      total_price: link.price,
      linkCode: linkCode
    }));

    console.log('[processPaymentLink] 결제 처리 화면 표시 중...');
    showPaymentProcessing();
    const payappWindow = window.open('', 'PayAppWindow', 'width=600,height=1200,scrollbars=yes');
    console.log('[processPaymentLink] PayApp.setTarget 및 payrequest 호출 중...');
    PayApp.setTarget('PayAppWindow');
    PayApp.payrequest();
    console.log('[processPaymentLink] 결제 요청 완료');
    
    // 팝업 닫힘 감지
    monitorPaymentWindow(payappWindow);

  } catch (error) {
    console.error('[processPaymentLink] 오류 발생:', error);
    alert('결제 처리 중 오류가 발생했습니다.');
  }
}

// 개인결제 링크로 결제 완료 시 처리
async function handlePaymentLinkComplete(payCode, orderId) {
  console.log('[handlePaymentLinkComplete] Started:', { payCode, orderId });
  
  try {
    // Check login token
    const token = getToken();
    if (!token) {
      console.warn('[handlePaymentLinkComplete] No token - login required');
      alert('Login is required. Please login and verify payment completion.');
      goLogin();
      return;
    }

    console.log('[handlePaymentLinkComplete] Order ID:', orderId);

    // Mark payment link as used
    try {
      await fetch(`/api/payment-links/${payCode}/use`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ order_id: orderId })
      });
      console.log('[handlePaymentLinkComplete] Payment link marked as used');
    } catch (e) {
      console.warn('[handlePaymentLinkComplete] Error marking link as used (continuing):', e);
    }

    // Fetch and display order info
    try {
      const orderRes = await fetch(`/api/orders/${orderId}`, {
        headers: { 'Authorization': `Bearer ${token}` }
      });
      const orderData = await orderRes.json();
      
      if (orderData.success && orderData.order) {
        const order = orderData.order;
        const totalPrice = order.total_price || 0;
        const orderCode = order.order_code || orderId;
        
        // Show order complete popup with order history navigation
        showOrderCompleteWithNavigation(orderId, orderCode, totalPrice);
      } else {
        console.warn('[handlePaymentLinkComplete] Failed to fetch order info');
        goOrderHistory();
      }
    } catch (e) {
      console.error('[handlePaymentLinkComplete] Error fetching order:', e);
      goOrderHistory();
    }

    // Clear payment link context
    if (window.paymentLinkContext) {
      console.log('[handlePaymentLinkComplete] Clearing payment link context');
      window.paymentLinkContext.complete();
    }

  } catch (error) {
    console.error('[handlePaymentLinkComplete] Error:', error);
    alert('Payment completed but an error occurred during processing.');
    // Clear context even on error
    if (window.paymentLinkContext) {
      window.paymentLinkContext.complete();
    }
    goHome();
  }
}

// 주문완료 팝업 표시 (확인 버튼 클릭 시 주문내역으로 이동)
function showOrderCompleteWithNavigation(orderId, orderCode, totalPrice) {
  const completeHtml = `
    <div style="position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.5); display:flex; align-items:center; justify-content:center; z-index:10000;">
      <div style="max-width:500px; width:90%; padding:40px; text-align:center; background:white; border-radius:16px; box-shadow:0 4px 20px rgba(0,0,0,0.2);">
        <div style="font-size:64px; margin-bottom:20px; animation:scaleIn 0.5s ease-out;">✅</div>
        <h1 style="color:#10b981; margin-bottom:15px; font-size:28px;">주문이 완료되었습니다!</h1>
        <p style="color:#64748b; margin-bottom:30px; line-height:1.8; font-size:16px;">
          결제가 정상적으로 완료되었습니다.<br>
          주문 내역은 [주문조회] 메뉴에서 확인할 수 있습니다.
        </p>
        <div style="background:#f1f5f9; padding:25px; border-radius:12px; margin-bottom:30px; border-left:4px solid #10b981;">
          <div style="font-size:13px; color:#64748b; margin-bottom:10px; font-weight:600;">주문번호</div>
          <div style="font-size:22px; font-weight:bold; color:#0f172a; font-family:'Courier New', monospace; margin-bottom:20px; letter-spacing:1px;">${orderCode}</div>
          <div style="font-size:13px; color:#64748b; margin-bottom:10px; font-weight:600;">결제금액</div>
          <div style="font-size:22px; font-weight:bold; color:#10b981;">${(totalPrice || 0).toLocaleString()}원</div>
        </div>
        <button onclick="goOrderHistory()" style="width:100%; padding:14px; background:#10b981; color:white; border:none; border-radius:8px; font-weight:700; font-size:16px; cursor:pointer; margin-bottom:10px; transition:background 0.3s;">주문 조회하기</button>
        <button onclick="goHome()" style="width:100%; padding:12px; background:#f1f5f9; color:#0f172a; border:none; border-radius:8px; font-weight:600; font-size:14px; cursor:pointer; transition:background 0.3s;">홈으로 돌아가기</button>
        <style>
          @keyframes scaleIn {
            from { transform: scale(0); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
          }
          button:hover { opacity: 0.9; }
        </style>
      </div>
    </div>
  `;
  
  const mainContent = document.querySelector('.main-content');
  if (mainContent) {
    mainContent.innerHTML = completeHtml;
    mainContent.style.display = 'block';
    mainContent.style.visibility = 'visible';
    mainContent.style.zIndex = '10000';
    document.querySelectorAll('[id^="view-"]').forEach(el => el.style.display = 'none');
  }
}

// ==================== 자동 실행 코드 ====================
console.log('[결제링크 인라인] 파일 로드 완료');

// 페이지 로드 시 자동으로 결제 링크 확인
if (document.readyState === 'loading') {
  console.log('[결제링크 인라인] DOM 로딩 중 - DOMContentLoaded 대기');
  document.addEventListener('DOMContentLoaded', () => {
    console.log('[결제링크 인라인] DOMContentLoaded 발생');
    checkPaymentLinkAccess();
  });
} else {
  console.log('[결제링크 인라인] DOM 이미 로드됨 - 즉시 실행');
  setTimeout(() => {
    console.log('[결제링크 인라인] setTimeout 실행');
    checkPaymentLinkAccess();
  }, 100);
}
console.log('[결제링크 인라인] 모든 함수 즉시 사용 가능 - 로드 완료');
  </script>

</body>
</html>